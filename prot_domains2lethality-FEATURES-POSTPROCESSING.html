

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Feature postprocessing from paper. &#8212; Notebooks for data science</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="What is the protein domain profile of genes from the same module ?" href="evaluating-protein-domains-per-module.html" />
    <link rel="prev" title="Replication of results from paper: “Predicting yeast synthetic lethal genetic interactions using protein domains”" href="prot_domains2lethality-PAPER-REPLICATION.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/butterfly.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Notebooks for data science</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
<li class="navbar-special">
<p class="margin-caption">Get started</p>
</li>
  <li class="">
    <a href="MysT_Notebooks.html">Notebooks written entirely in markdown</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Machine learning related projects</p>
</li>
  <li class="">
    <a href="tutorial-categorical-data-on-yeast-interactions.html">Tutorial on how to handle categorical data from here</a>
  </li>
  <li class="">
    <a href="prot_domains2lethality-PAPER-REPLICATION.html">Replication of results from paper: “Predicting yeast synthetic lethal genetic interactions using protein domains”</a>
  </li>
  <li class="active">
    <a href="">Feature postprocessing from paper.</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Bioinformatics examples</p>
</li>
  <li class="">
    <a href="evaluating-protein-domains-per-module.html">What is the protein domain profile of genes from the same module ?</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/prot_domains2lethality-FEATURES-POSTPROCESSING.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/prot_domains2lethality-FEATURES-POSTPROCESSING.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/leilaicruz/jupyter-bookk"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/leilaicruz/jupyter-bookk/issues/new?title=Issue%20on%20page%20%2Fprot_domains2lethality-FEATURES-POSTPROCESSING.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/leilaicruz/jupyter-bookk/master?urlpath=tree/mini_book/docs/prot_domains2lethality-FEATURES-POSTPROCESSING.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebelabSBT()" title="Launch Thebelab" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#importing-datasets" class="nav-link">Importing datasets</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#link-to-the-github-repo-where-the-datasets-to-be-downloaded" class="nav-link">Link to the github repo where the datasets to be downloaded:</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#building-the-feature-matrix" class="nav-link">Building the feature matrix</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#building-the-list-of-proteins-domains-id-per-protein-pair-separately" class="nav-link">Building the list of proteins domains id per protein pair separately :</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#postprocessing-1-remove-protein-pairs-from-study-if-either-protein-in-the-pair-does-not-contain-any-domain" class="nav-link">Postprocessing #1:  Remove protein pairs from study if either protein in the pair does not contain any domain</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#feature-engineering-select-from-each-ordered-indexes-of-domain-id-list-which-of-them-appear-once-in-both-or-in-any-of-the-domains-of-each-protein-pair" class="nav-link">Feature engineering: Select from each ordered indexes of domain id list which of them appear once, in both or in any of the domains of each protein pair</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#define-function-get-indexes" class="nav-link">Define function get_indexes</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#how-many-ones-and-twos-are-in-each-dataset" class="nav-link">How many ones and twos are in each dataset</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#bar-plot-to-visualize-these-numbers" class="nav-link">Bar plot to visualize these numbers</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#adding-the-labels-response-variables-to-each-dataset" class="nav-link">Adding the labels(response variables) to each dataset</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#joining-both-datasets" class="nav-link">Joining both datasets</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#postprocessing-and-exploration-of-the-feature-matrix-of-both-datasets" class="nav-link">Postprocessing and exploration of the feature matrix of both datasets</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#viz-of-the-stats" class="nav-link">Viz of the stats</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#how-redundant-are-each-of-the-protein-domains" class="nav-link">How redundant are each of the protein domains?</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#which-are-the-shared-domains-between-nsl-and-sl-pairs-in-the-pca-reduced-samples" class="nav-link">which are the shared domains between nSL and SL pairs , in the PCA reduced samples</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#domains-exclusive-to-sl" class="nav-link">Domains exclusive to SL</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#let-see-to-the-domains-number-that-get-repeated-after-the-pca-analysis-and-selecting-the-most-explanatory-feature-by-its-explained-variance" class="nav-link">Let see to the domains-number that get repeated after the PCA analysis , and selecting the most explanatory feature by its explained variance.</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#proof-of-concept-with-bem1" class="nav-link">Proof of concept with BEM1</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="feature-postprocessing-from-paper">
<h1>Feature postprocessing from paper.<a class="headerlink" href="#feature-postprocessing-from-paper" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Title:  “Predicting yeast synthetic lethal genetic interactions using protein domains”</p></li>
<li><p>Authors: Bo Li, Feng Luo,School of Computing,Clemson University,Clemson, SC, USA</p></li>
<li><p>e-mail: bol, luofeng&#64;clemson.edu</p></li>
<li><p>year:2009</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span> 
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">random</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="importing-datasets">
<h2>Importing datasets<a class="headerlink" href="#importing-datasets" title="Permalink to this headline">¶</a></h2>
<div class="section" id="link-to-the-github-repo-where-the-datasets-to-be-downloaded">
<h3>Link to the github repo where the datasets to be downloaded:<a class="headerlink" href="#link-to-the-github-repo-where-the-datasets-to-be-downloaded" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/leilaicruz/machine-learning-for-yeast/tree/dev_Leila/datasets-for-learning">DOWNLOAD THE DATASETS HERE</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="s1">&#39;__file__&#39;</span><span class="p">)</span> <span class="c1">#&lt;-- absolute dir the script is in</span>
<span class="n">rel_path_SL</span> <span class="o">=</span> <span class="s2">&quot;datasets/data-synthetic-lethals.xlsx&quot;</span>
<span class="n">rel_path_nSL</span><span class="o">=</span><span class="s2">&quot;datasets/data-positive-genetic.xlsx&quot;</span>
<span class="n">rel_path_domains</span><span class="o">=</span><span class="s2">&quot;datasets/proteins-domains-from-Pfam.xlsx&quot;</span>

<span class="n">abs_file_path_SL</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="n">rel_path_SL</span><span class="p">)</span>
<span class="n">abs_file_path_nSL</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="n">rel_path_nSL</span><span class="p">)</span>
<span class="n">abs_file_path_domains</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="n">rel_path_domains</span><span class="p">)</span>

<span class="c1"># os.chdir(&#39;mini_book/docs/&#39;) #&lt;-- for binder os.chdir(&#39;../&#39;)</span>
<span class="c1"># os.chdir(&#39;../&#39;)</span>
<span class="n">my_path_sl</span><span class="o">=</span> <span class="n">abs_file_path_SL</span>
<span class="n">my_path_non_sl</span><span class="o">=</span><span class="n">abs_file_path_nSL</span>
<span class="n">my_path_domains</span><span class="o">=</span><span class="n">abs_file_path_domains</span>

<span class="n">data_sl</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">my_path_sl</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data_domains</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">my_path_domains</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">)</span>
<span class="n">data_domains</span><span class="o">=</span><span class="n">data_domains</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">data_nonsl</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">my_path_non_sl</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="building-the-feature-matrix">
<h2>Building the feature matrix<a class="headerlink" href="#building-the-feature-matrix" title="Permalink to this headline">¶</a></h2>
<p>One matrix for true SL where each row is one pair of SL. Every raw will be a vector of 0,1 or 2 depending on the comparison with the domain list. For row i the jth element = 0 if the jth element of the domain list is not in neither protein A and B, 1, if it is in one of them and 2 if it is in both of them .</p>
<div class="section" id="building-the-list-of-proteins-domains-id-per-protein-pair-separately">
<h3>Building the list of proteins domains id per protein pair separately :<a class="headerlink" href="#building-the-list-of-proteins-domains-id-per-protein-pair-separately" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>List of protein A: Search for the Sl/nSL database the query gene name and look in the protein domain database which protein domains id has each of those queries.</p></li>
<li><p>List of protein B: Search for the Sl/nSL database the target gene name of the previous query and look in the protein domain database which protein domains id has each of those target genes.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Selecting the meaningful columns in the respective dataset</span>
<span class="n">domain_id_list</span><span class="o">=</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span>
<span class="n">query_gene</span><span class="o">=</span><span class="n">data_sl</span><span class="p">[</span><span class="s1">&#39;gene-query-name&#39;</span><span class="p">]</span>
<span class="n">target_gene</span><span class="o">=</span><span class="n">data_sl</span><span class="p">[</span><span class="s1">&#39;gene-target-name&#39;</span><span class="p">]</span>
<span class="n">query_gene_nonlethal</span><span class="o">=</span><span class="n">data_nonsl</span><span class="p">[</span><span class="s1">&#39;gene-query-name&#39;</span><span class="p">]</span>
<span class="n">target_gene_nonlethal</span><span class="o">=</span><span class="n">data_nonsl</span><span class="p">[</span><span class="s1">&#39;gene-target-name&#39;</span><span class="p">]</span>



<span class="c1"># Initialising the arrays</span>
<span class="n">protein_a_list</span><span class="o">=</span><span class="p">[]</span>
<span class="n">protein_b_list</span><span class="o">=</span><span class="p">[]</span>
<span class="n">protein_a_list_non</span><span class="o">=</span><span class="p">[]</span>
<span class="n">protein_b_list_non</span><span class="o">=</span><span class="p">[]</span>

<span class="n">population</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data_sl</span><span class="p">))</span>

<span class="c1"># For loop for 10000 pairs sampled randomly from the SL/nSl pair list , and creating a big array of proteind domains id per protein pair</span>

<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">population</span><span class="p">),</span> <span class="mi">500</span><span class="p">):</span>
    <span class="n">protein_a</span><span class="o">=</span><span class="n">data_domains</span><span class="p">[</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">query_gene</span><span class="p">[</span><span class="n">m</span><span class="p">]]</span>
    <span class="n">protein_b</span><span class="o">=</span><span class="n">data_domains</span><span class="p">[</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">target_gene</span><span class="p">[</span><span class="n">m</span><span class="p">]]</span>
    <span class="n">protein_a_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protein_a</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="n">protein_b_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protein_b</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

    <span class="n">protein_a_non</span><span class="o">=</span><span class="n">data_domains</span><span class="p">[</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">query_gene_nonlethal</span><span class="p">[</span><span class="n">m</span><span class="p">]]</span>
    <span class="n">protein_b_non</span><span class="o">=</span><span class="n">data_domains</span><span class="p">[</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">target_gene_nonlethal</span><span class="p">[</span><span class="n">m</span><span class="p">]]</span>
    <span class="n">protein_a_list_non</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protein_a_non</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="n">protein_b_list_non</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protein_b_non</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;We are going to analyze&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">((</span><span class="n">protein_a_list</span><span class="p">))</span> <span class="p">,</span><span class="s1">&#39;protein pairs, out of&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data_sl</span><span class="p">),</span><span class="s1">&#39;SL protein pairs&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;We are going to analyze&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">((</span><span class="n">protein_a_list_non</span><span class="p">))</span> <span class="p">,</span><span class="s1">&#39;protein pairs, out of&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data_nonsl</span><span class="p">),</span><span class="s1">&#39;positive protein pairs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>We are going to analyze 500 protein pairs, out of 17871 SL protein pairs
We are going to analyze 500 protein pairs, out of 43340 positive protein pairs
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="postprocessing-1-remove-protein-pairs-from-study-if-either-protein-in-the-pair-does-not-contain-any-domain">
<h3>Postprocessing #1:  Remove protein pairs from study if either protein in the pair does not contain any domain<a class="headerlink" href="#postprocessing-1-remove-protein-pairs-from-study-if-either-protein-in-the-pair-does-not-contain-any-domain" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">remove_empty_domains</span><span class="p">(</span><span class="n">protein_list_search</span><span class="p">,</span><span class="n">protein_list_pair</span><span class="p">):</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_list_search</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">protein_list_search</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="p">[]</span> <span class="ow">or</span> <span class="n">protein_list_pair</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="p">[]:</span>
            <span class="n">index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="c1">## index of empty values for the protein_a_list meaning they dont have any annotated domain</span>

    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_list_search</span><span class="p">))</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index</span><span class="p">]</span> <span class="c1"># a list with non empty values from protein_a list</span>

    <span class="n">protein_list_search_new</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">protein_list_pair_new</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y</span><span class="p">:</span>
        <span class="n">protein_list_search_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protein_list_search</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">protein_list_pair_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protein_list_pair</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">protein_list_search_new</span><span class="p">,</span><span class="n">protein_list_pair_new</span>

<span class="c1">## evaluating the function</span>

<span class="n">protein_a_list_new</span><span class="p">,</span><span class="n">protein_b_list_new</span><span class="o">=</span><span class="n">remove_empty_domains</span><span class="p">(</span><span class="n">protein_a_list</span><span class="p">,</span><span class="n">protein_b_list</span><span class="p">)</span>

<span class="n">protein_a_list_non_new</span><span class="p">,</span><span class="n">protein_b_list_non_new</span><span class="o">=</span><span class="n">remove_empty_domains</span><span class="p">(</span><span class="n">protein_a_list_non</span><span class="p">,</span><span class="n">protein_b_list_non</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The empty domain in the SL were:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_new</span><span class="p">),</span> <span class="s1">&#39;out of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list</span><span class="p">),</span><span class="s1">&#39;domains&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The empty domain in the nSL were:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_non</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_non_new</span><span class="p">),</span> <span class="s1">&#39;out of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_non</span><span class="p">),</span><span class="s1">&#39;domains&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>The empty domain in the SL were: 83 out of 500 domains
The empty domain in the nSL were: 98 out of 500 domains
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="feature-engineering-select-from-each-ordered-indexes-of-domain-id-list-which-of-them-appear-once-in-both-or-in-any-of-the-domains-of-each-protein-pair">
<h3>Feature engineering: Select from each ordered indexes of domain id list which of them appear once, in both or in any of the domains of each protein pair<a class="headerlink" href="#feature-engineering-select-from-each-ordered-indexes-of-domain-id-list-which-of-them-appear-once-in-both-or-in-any-of-the-domains-of-each-protein-pair" title="Permalink to this headline">¶</a></h3>
<div class="section" id="define-function-get-indexes">
<h4>Define function <code class="docutils literal notranslate"><span class="pre">get_indexes</span></code><a class="headerlink" href="#define-function-get-indexes" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get_indexes</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">xs</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)))</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">]</span> <span class="c1"># a function that give the index of whether a value appear in array or not</span>
<span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="n">get_indexes</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[1, 2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">feature_building</span><span class="p">(</span><span class="n">protein_a_list_new</span><span class="p">,</span><span class="n">protein_b_list_new</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">domain_id_list</span><span class="p">)</span>
    <span class="c1">## To avoid taking repeated domains from one protein of the pairs , lets reduced the domains of each protein from the pairs to their unique members</span>
    <span class="n">protein_a_list_unique</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">protein_b_list_unique</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_new</span><span class="p">)):</span>
        <span class="n">protein_a_list_unique</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">protein_a_list_new</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">protein_b_list_unique</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">protein_b_list_new</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        
    <span class="n">protein_feat_true</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_unique</span><span class="p">)))</span>
    <span class="n">pair_a_b_array</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_unique</span><span class="p">)):</span>
        <span class="n">index_a</span><span class="o">=</span><span class="p">[]</span>
        
        <span class="n">pair</span><span class="o">=</span><span class="p">[</span><span class="n">protein_a_list_unique</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">protein_b_list_unique</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">pair_a_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">pair_a_b_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair_a_b</span><span class="p">)</span>

    <span class="n">j</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pair_a_b_array</span><span class="p">:</span>  
        <span class="n">array</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">counts</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">m</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span><span class="n">array</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">protein_feat_true</span><span class="p">[</span><span class="n">get_indexes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span>
                
            <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">protein_feat_true</span><span class="p">[</span><span class="n">get_indexes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
        <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">protein_feat_true</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">protein_feat_true</span><span class="o">=</span><span class="n">feature_building</span><span class="p">(</span><span class="n">protein_b_list_new</span><span class="o">=</span><span class="n">protein_b_list_new</span><span class="p">,</span><span class="n">protein_a_list_new</span><span class="o">=</span><span class="n">protein_a_list_new</span><span class="p">)</span>
<span class="n">protein_feat_true_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">protein_feat_true</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">protein_feat_non_true</span><span class="o">=</span><span class="n">feature_building</span><span class="p">(</span><span class="n">protein_b_list_new</span><span class="o">=</span><span class="n">protein_b_list_non_new</span><span class="p">,</span><span class="n">protein_a_list_new</span><span class="o">=</span><span class="n">protein_a_list_non_new</span><span class="p">)</span>
<span class="n">protein_feat_non_true_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">protein_feat_non_true</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="how-many-ones-and-twos-are-in-each-dataset">
<h3>How many ones and twos are in each dataset<a class="headerlink" href="#how-many-ones-and-twos-are-in-each-dataset" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">index_2_true</span><span class="o">=</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
<span class="n">index_2_true_count</span><span class="o">=</span><span class="n">index_2_true</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">index_1_true</span><span class="o">=</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
<span class="n">index_1_true_count</span><span class="o">=</span><span class="n">index_1_true</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">index_2_nontrue</span><span class="o">=</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
<span class="n">index_2_nontrue_count</span><span class="o">=</span><span class="n">index_2_nontrue</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">index_1_nontrue</span><span class="o">=</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
<span class="n">index_1_nontrue_count</span><span class="o">=</span><span class="n">index_1_nontrue</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fraction of twos in the SL array is&#39;</span><span class="p">,</span><span class="n">index_2_true_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fraction of ones in the SL array is&#39;</span><span class="p">,</span><span class="n">index_1_true_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fraction of twos in the PI array is&#39;</span><span class="p">,</span><span class="n">index_2_nontrue_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fraction of ones in the PI array is&#39;</span><span class="p">,</span><span class="n">index_1_nontrue_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>fraction of twos in the SL array is 3.408843173395168e-05
fraction of ones in the SL array is 0.0009909427829637117
fraction of twos in the PI array is 3.2893384318079027e-06
fraction of ones in the PI array is 0.0009284157723777805
</pre></div>
</div>
</div>
</div>
<div class="section" id="bar-plot-to-visualize-these-numbers">
<h4>Bar plot to visualize these numbers<a class="headerlink" href="#bar-plot-to-visualize-these-numbers" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;fraction of 2 in the nSL&#39;</span><span class="p">,</span><span class="s1">&#39;fraction of 1 in the nSL&#39;</span><span class="p">],[</span><span class="n">index_2_nontrue_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span><span class="n">index_1_nontrue_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">))],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;lightblue&#39;</span><span class="p">]),</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;fraction of 2 in SL &#39;</span><span class="p">,</span><span class="s1">&#39;fraction of 1 in SL&#39;</span><span class="p">],[</span><span class="n">index_2_true_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span><span class="n">index_1_true_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">))],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;coral&#39;</span><span class="p">,</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fraction from the population&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>([0, 1, 2, 3], &lt;a list of 4 Text major ticklabel objects&gt;)
</pre></div>
</div>
<img alt="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_18_1.png" src="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_18_1.png" />
</div>
</div>
</div>
<div class="section" id="adding-the-labels-response-variables-to-each-dataset">
<h4>Adding the labels(response variables) to each dataset<a class="headerlink" href="#adding-the-labels-response-variables-to-each-dataset" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">protein_feat_true_pd</span><span class="p">[</span><span class="s1">&#39;lethality&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_new</span><span class="p">)))</span>
<span class="n">protein_feat_non_true_pd</span><span class="p">[</span><span class="s1">&#39;lethality&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_non_new</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="joining-both-datasets">
<h4>Joining both datasets<a class="headerlink" href="#joining-both-datasets" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">feature_post</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">protein_feat_true_pd</span><span class="p">,</span><span class="n">protein_feat_non_true_pd</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">feature_post</span><span class="o">=</span><span class="n">feature_post</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_new</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_non_new</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of features are:&#39;</span><span class="p">,</span><span class="n">feature_post</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of samples are:&#39;</span><span class="p">,</span><span class="n">feature_post</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>The number of features are: 3026
The number of samples are: 819
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="postprocessing-and-exploration-of-the-feature-matrix-of-both-datasets">
<h3>Postprocessing and exploration of the feature matrix of both datasets<a class="headerlink" href="#postprocessing-and-exploration-of-the-feature-matrix-of-both-datasets" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="o">=</span><span class="n">feature_post</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
<span class="n">std</span><span class="o">=</span><span class="n">feature_post</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span>
<span class="n">lethality</span><span class="o">=</span><span class="n">feature_post</span><span class="p">[</span><span class="s1">&#39;lethality&#39;</span><span class="p">]</span>

<span class="n">corr_keys</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mean</span><span class="p">,</span><span class="n">std</span><span class="p">,</span><span class="n">lethality</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="viz-of-the-stats">
<h3>Viz of the stats<a class="headerlink" href="#viz-of-the-stats" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pair</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">corr_keys</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;lethality&#39;</span><span class="p">,</span><span class="n">diag_kind</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;reg&#39;</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)</span>
<span class="n">pair</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Pairplot to see data dependencies with Lethality&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">1.08</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.08, &#39;Pairplot to see data dependencies with Lethality&#39;)
</pre></div>
</div>
<img alt="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_26_1.png" src="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">feature_post</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lethality&quot;</span><span class="p">]),</span> <span class="n">feature_post</span><span class="p">[</span><span class="s2">&quot;lethality&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">x_sl</span><span class="o">=</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lethality&#39;</span><span class="p">])</span>
<span class="n">x_nsl</span><span class="o">=</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lethality&#39;</span><span class="p">])</span>

<span class="n">X_sl_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_sl</span><span class="p">)</span>
<span class="n">X_nsl_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_nsl</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_sl_scaled</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(417, 3025)
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="how-redundant-are-each-of-the-protein-domains">
<h2>How redundant are each of the protein domains?<a class="headerlink" href="#how-redundant-are-each-of-the-protein-domains" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">PCA_component_contribution</span><span class="p">(</span><span class="n">scaled_matrix</span><span class="p">,</span><span class="n">original_data</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_matrix</span><span class="p">)</span>
    <span class="c1">## apply dimensionality reduction to X_train</span>
    <span class="n">output_pca</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">scaled_matrix</span><span class="p">)</span>
    
    <span class="n">total</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">explained_variance_</span><span class="p">)</span>


   
    <span class="c1"># number of components , that it will be the number of main axes times the number of original components </span>
    <span class="n">n_pcs</span><span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">components_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># the amount of non redundant protein domains </span>

    <span class="c1"># get the index of the most important feature on EACH component</span>
    <span class="c1"># LIST COMPREHENSION HERE</span>
    <span class="n">most_important</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_pcs</span><span class="p">)]</span>

    <span class="n">initial_feature_names</span> <span class="o">=</span> <span class="n">original_data</span><span class="o">.</span><span class="n">columns</span>
    <span class="c1"># get the names</span>
    <span class="n">most_important_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_feature_names</span><span class="p">[</span><span class="n">most_important</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_pcs</span><span class="p">)]</span>
    

    <span class="c1"># LIST COMPREHENSION HERE AGAIN</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PC</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="n">most_important_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_pcs</span><span class="p">)}</span>

    <span class="c1"># build the dataframe</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pca-component&#39;</span><span class="p">,</span><span class="s1">&#39;domain-number&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">df</span><span class="p">,</span><span class="n">model</span><span class="o">.</span><span class="n">components_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_sl</span><span class="p">,</span><span class="n">components_pca_nsl</span><span class="o">=</span><span class="n">PCA_component_contribution</span><span class="p">(</span><span class="n">X_nsl_scaled</span><span class="p">,</span><span class="n">x_nsl</span><span class="p">)</span>
<span class="n">df_nsl</span><span class="p">,</span><span class="n">components_pca_sl</span><span class="o">=</span><span class="n">PCA_component_contribution</span><span class="p">(</span><span class="n">X_sl_scaled</span><span class="p">,</span><span class="n">x_sl</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_sl</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pca-component</th>
      <th>domain-number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PC0</td>
      <td>180</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PC1</td>
      <td>1671</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PC2</td>
      <td>540</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PC3</td>
      <td>79</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PC4</td>
      <td>1633</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="which-are-the-shared-domains-between-nsl-and-sl-pairs-in-the-pca-reduced-samples">
<h2>which are the shared domains between nSL and SL pairs , in the PCA reduced samples<a class="headerlink" href="#which-are-the-shared-domains-between-nsl-and-sl-pairs-in-the-pca-reduced-samples" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_shared_domains</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_sl</span><span class="p">,</span><span class="n">df_nsl</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;domain-number&#39;</span><span class="p">)</span>
<span class="n">domains_name</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">domains_description</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-descrip&#39;</span><span class="p">])</span>

<span class="n">df_shared_domains</span><span class="p">[</span><span class="s1">&#39;domain-description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_description</span><span class="p">[</span><span class="n">df_shared_domains</span><span class="p">[</span><span class="s1">&#39;domain-number&#39;</span><span class="p">]]</span>


<span class="n">df_shared_domains</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pca-component_x</th>
      <th>domain-number</th>
      <th>pca-component_y</th>
      <th>domain-description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PC5</td>
      <td>55</td>
      <td>PC11</td>
      <td>ADK</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PC11</td>
      <td>341</td>
      <td>PC42</td>
      <td>CDP-OH_P_transf; CDP-alcohol phosphatidyltrans...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PC12</td>
      <td>741</td>
      <td>PC219</td>
      <td>DUF846; Protein of unknown function DUF846, eu...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PC13</td>
      <td>384</td>
      <td>PC23</td>
      <td>COPI_assoc; Golgi apparatus membrane protein T...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PC22</td>
      <td>926</td>
      <td>PC18</td>
      <td>Flp_C; Recombinase Flp protein</td>
    </tr>
    <tr>
      <th>5</th>
      <td>PC27</td>
      <td>1001</td>
      <td>PC78</td>
      <td>GRIP; GRIP domain</td>
    </tr>
    <tr>
      <th>6</th>
      <td>PC35</td>
      <td>2545</td>
      <td>PC59</td>
      <td>Syja_N; SAC domain</td>
    </tr>
    <tr>
      <th>7</th>
      <td>PC46</td>
      <td>1349</td>
      <td>PC52</td>
      <td>MARVEL; Marvel domain</td>
    </tr>
    <tr>
      <th>8</th>
      <td>PC46</td>
      <td>1349</td>
      <td>PC53</td>
      <td>MARVEL; Marvel domain</td>
    </tr>
    <tr>
      <th>9</th>
      <td>PC50</td>
      <td>1349</td>
      <td>PC52</td>
      <td>MARVEL; Marvel domain</td>
    </tr>
    <tr>
      <th>10</th>
      <td>PC50</td>
      <td>1349</td>
      <td>PC53</td>
      <td>MARVEL; Marvel domain</td>
    </tr>
    <tr>
      <th>11</th>
      <td>PC63</td>
      <td>10</td>
      <td>PC71</td>
      <td>4HBT; Thioesterase domain</td>
    </tr>
    <tr>
      <th>12</th>
      <td>PC63</td>
      <td>10</td>
      <td>PC74</td>
      <td>4HBT; Thioesterase domain</td>
    </tr>
    <tr>
      <th>13</th>
      <td>PC66</td>
      <td>179</td>
      <td>PC34</td>
      <td>Aim19; Altered inheritance of mitochondria pro...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>PC82</td>
      <td>876</td>
      <td>PC65</td>
      <td>FDX-ACB; Ferrodoxin-fold anticodon-binding domain</td>
    </tr>
    <tr>
      <th>15</th>
      <td>PC88</td>
      <td>876</td>
      <td>PC65</td>
      <td>FDX-ACB; Ferrodoxin-fold anticodon-binding domain</td>
    </tr>
    <tr>
      <th>16</th>
      <td>PC99</td>
      <td>1585</td>
      <td>PC56</td>
      <td>NPR3; Nitrogen permease regulator 3</td>
    </tr>
    <tr>
      <th>17</th>
      <td>PC115</td>
      <td>618</td>
      <td>PC195</td>
      <td>DNA_pol_alpha_N; DNA polymerase alpha catalyti...</td>
    </tr>
    <tr>
      <th>18</th>
      <td>PC131</td>
      <td>618</td>
      <td>PC195</td>
      <td>DNA_pol_alpha_N; DNA polymerase alpha catalyti...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>PC116</td>
      <td>404</td>
      <td>PC101</td>
      <td>CPSF100_C; Cleavage and polyadenylation specif...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>PC128</td>
      <td>404</td>
      <td>PC101</td>
      <td>CPSF100_C; Cleavage and polyadenylation specif...</td>
    </tr>
    <tr>
      <th>21</th>
      <td>PC117</td>
      <td>1267</td>
      <td>PC163</td>
      <td>Kelch_3</td>
    </tr>
    <tr>
      <th>22</th>
      <td>PC119</td>
      <td>1267</td>
      <td>PC163</td>
      <td>Kelch_3</td>
    </tr>
    <tr>
      <th>23</th>
      <td>PC120</td>
      <td>1267</td>
      <td>PC163</td>
      <td>Kelch_3</td>
    </tr>
    <tr>
      <th>24</th>
      <td>PC118</td>
      <td>21</td>
      <td>PC76</td>
      <td>AAA_23</td>
    </tr>
    <tr>
      <th>25</th>
      <td>PC125</td>
      <td>1733</td>
      <td>PC174</td>
      <td>PGAP1; GPI inositol-deacylase PGAP1-like</td>
    </tr>
    <tr>
      <th>26</th>
      <td>PC125</td>
      <td>1733</td>
      <td>PC175</td>
      <td>PGAP1; GPI inositol-deacylase PGAP1-like</td>
    </tr>
    <tr>
      <th>27</th>
      <td>PC138</td>
      <td>299</td>
      <td>PC216</td>
      <td>Bmt2; 25S rRNA (adenine(2142)-N(1))-methyltran...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>PC143</td>
      <td>1114</td>
      <td>PC255</td>
      <td>HHH_5</td>
    </tr>
    <tr>
      <th>29</th>
      <td>PC143</td>
      <td>1114</td>
      <td>PC256</td>
      <td>HHH_5</td>
    </tr>
    <tr>
      <th>30</th>
      <td>PC150</td>
      <td>27</td>
      <td>PC146</td>
      <td>AAA_8; Dynein heavy chain, P-loop containing D...</td>
    </tr>
    <tr>
      <th>31</th>
      <td>PC158</td>
      <td>250</td>
      <td>PC183</td>
      <td>B3_4; B3/B4 tRNA-binding domain</td>
    </tr>
    <tr>
      <th>32</th>
      <td>PC163</td>
      <td>11</td>
      <td>PC113</td>
      <td>5-FTHF_cyc-lig; 5-formyltetrahydrofolate cyclo...</td>
    </tr>
    <tr>
      <th>33</th>
      <td>PC172</td>
      <td>1688</td>
      <td>PC80</td>
      <td>PA14; PA14 domain</td>
    </tr>
    <tr>
      <th>34</th>
      <td>PC188</td>
      <td>1688</td>
      <td>PC80</td>
      <td>PA14; PA14 domain</td>
    </tr>
    <tr>
      <th>35</th>
      <td>PC174</td>
      <td>1303</td>
      <td>PC252</td>
      <td>LRR_8; Leucine-rich repeat</td>
    </tr>
    <tr>
      <th>36</th>
      <td>PC177</td>
      <td>2916</td>
      <td>PC199</td>
      <td>fn3_2; Fibronectin type III domain, fungi</td>
    </tr>
    <tr>
      <th>37</th>
      <td>PC180</td>
      <td>622</td>
      <td>PC134</td>
      <td>DNA_topoisoIV; DNA topoisomerase, type IIA, su...</td>
    </tr>
    <tr>
      <th>38</th>
      <td>PC180</td>
      <td>622</td>
      <td>PC135</td>
      <td>DNA_topoisoIV; DNA topoisomerase, type IIA, su...</td>
    </tr>
    <tr>
      <th>39</th>
      <td>PC183</td>
      <td>6</td>
      <td>PC94</td>
      <td>2OG-FeII_Oxy_4</td>
    </tr>
    <tr>
      <th>40</th>
      <td>PC184</td>
      <td>161</td>
      <td>PC105</td>
      <td>Acyl-CoA_ox_N; Acyl-coenzyme A oxidase, N-term...</td>
    </tr>
    <tr>
      <th>41</th>
      <td>PC185</td>
      <td>161</td>
      <td>PC105</td>
      <td>Acyl-CoA_ox_N; Acyl-coenzyme A oxidase, N-term...</td>
    </tr>
    <tr>
      <th>42</th>
      <td>PC196</td>
      <td>2551</td>
      <td>PC261</td>
      <td>TAF4; Transcription initiation factor TFIID co...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>PC208</td>
      <td>1429</td>
      <td>PC112</td>
      <td>Mcl1_mid; Minichromosome loss protein Mcl1, mi...</td>
    </tr>
    <tr>
      <th>44</th>
      <td>PC211</td>
      <td>867</td>
      <td>PC123</td>
      <td>FAD_binding_7; Cryptochrome/DNA photolyase, FA...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>PC225</td>
      <td>4</td>
      <td>PC234</td>
      <td>2-oxoacid_dh; 2-oxoacid dehydrogenase acyltran...</td>
    </tr>
    <tr>
      <th>46</th>
      <td>PC237</td>
      <td>704</td>
      <td>PC248</td>
      <td>DUF3543; Serine/threonine-protein kinase, C-te...</td>
    </tr>
    <tr>
      <th>47</th>
      <td>PC240</td>
      <td>704</td>
      <td>PC248</td>
      <td>DUF3543; Serine/threonine-protein kinase, C-te...</td>
    </tr>
    <tr>
      <th>48</th>
      <td>PC255</td>
      <td>2952</td>
      <td>PC85</td>
      <td>tRNA_int_end_N2; tRNA-splicing endonuclease, s...</td>
    </tr>
    <tr>
      <th>49</th>
      <td>PC267</td>
      <td>1570</td>
      <td>PC158</td>
      <td>NMD3</td>
    </tr>
    <tr>
      <th>50</th>
      <td>PC267</td>
      <td>1570</td>
      <td>PC159</td>
      <td>NMD3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of shared domains between SL and nSL pairs,after PCA, is = &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df_shared_domains</span><span class="p">),</span> <span class="s1">&#39;out of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_sl</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl</span><span class="p">),</span> <span class="s1">&#39;so the&#39;</span><span class="p">,</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df_shared_domains</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sl</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl</span><span class="p">)),</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>The number of shared domains between SL and nSL pairs,after PCA, is =  51 out of 549 so the 9.289617486338798 %
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="domains-exclusive-to-sl">
<h2>Domains exclusive to SL<a class="headerlink" href="#domains-exclusive-to-sl" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_sl_exclusive</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_sl</span><span class="p">,</span><span class="n">df_nsl</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;domain-number&#39;</span><span class="p">)</span>

<span class="n">domains_name</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">domains_description</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-descrip&#39;</span><span class="p">])</span>

<span class="n">df_sl_exclusive</span><span class="p">[</span><span class="s1">&#39;domain-description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_description</span><span class="p">[</span><span class="n">df_sl_exclusive</span><span class="p">[</span><span class="s1">&#39;domain-number&#39;</span><span class="p">]]</span>
<span class="n">df_sl_exclusive</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">df_sl_exclusive</span><span class="p">[</span><span class="s1">&#39;pca-component_y&#39;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pca-component_x</th>
      <th>domain-number</th>
      <th>pca-component_y</th>
      <th>domain-description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PC0</td>
      <td>180</td>
      <td>NaN</td>
      <td>Aim21; Altered inheritance of mitochondria pro...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PC1</td>
      <td>1671</td>
      <td>NaN</td>
      <td>Ofd1_CTDD; Oxoglutarate/iron-dependent oxygena...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PC2</td>
      <td>540</td>
      <td>NaN</td>
      <td>Cytochrome_B; Cytochrome b/b6, N-terminal</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PC3</td>
      <td>79</td>
      <td>NaN</td>
      <td>AMPK1_CBM; AMP-activated protein kinase, glyco...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PC4</td>
      <td>1633</td>
      <td>NaN</td>
      <td>Nrap_D3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>286</th>
      <td>PC279</td>
      <td>1365</td>
      <td>NaN</td>
      <td>MF_alpha; Mating factor alpha, C-terminal repeat</td>
    </tr>
    <tr>
      <th>287</th>
      <td>PC280</td>
      <td>2710</td>
      <td>NaN</td>
      <td>Trypsin_2</td>
    </tr>
    <tr>
      <th>288</th>
      <td>PC281</td>
      <td>407</td>
      <td>NaN</td>
      <td>CPSase_L_D2; Carbamoyl-phosphate synthetase la...</td>
    </tr>
    <tr>
      <th>289</th>
      <td>PC282</td>
      <td>811</td>
      <td>NaN</td>
      <td>EPL1; Enhancer of polycomb-like, N-terminal</td>
    </tr>
    <tr>
      <th>290</th>
      <td>PC283</td>
      <td>980</td>
      <td>NaN</td>
      <td>GFD1</td>
    </tr>
  </tbody>
</table>
<p>240 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of exclusive domains from SL pairs, after PCA, is = &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sl_exclusive</span><span class="p">),</span> <span class="s1">&#39;out of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_sl</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl</span><span class="p">),</span> <span class="s1">&#39;so the&#39;</span><span class="p">,</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sl_exclusive</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sl</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl</span><span class="p">)),</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>The number of exclusive domains from SL pairs, after PCA, is =  291 out of 549 so the 53.005464480874316 %
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_nsl_exclusive</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_sl</span><span class="p">,</span><span class="n">df_nsl</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;domain-number&#39;</span><span class="p">)</span>

<span class="n">domains_name</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">domains_description</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-descrip&#39;</span><span class="p">])</span>

<span class="n">df_nsl_exclusive</span><span class="p">[</span><span class="s1">&#39;domain-description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_description</span><span class="p">[</span><span class="n">df_nsl_exclusive</span><span class="p">[</span><span class="s1">&#39;domain-number&#39;</span><span class="p">]]</span>
<span class="n">df_nsl_exclusive</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">df_nsl_exclusive</span><span class="p">[</span><span class="s1">&#39;pca-component_x&#39;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pca-component_x</th>
      <th>domain-number</th>
      <th>pca-component_y</th>
      <th>domain-description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>51</th>
      <td>NaN</td>
      <td>305</td>
      <td>PC0</td>
      <td>Brr6_like_C_C; Brl1/Brr6 domain</td>
    </tr>
    <tr>
      <th>52</th>
      <td>NaN</td>
      <td>1425</td>
      <td>PC1</td>
      <td>Mannosyl_trans; Mannosyltransferase, DXD</td>
    </tr>
    <tr>
      <th>53</th>
      <td>NaN</td>
      <td>1252</td>
      <td>PC2</td>
      <td>JmjN; JmjN domain</td>
    </tr>
    <tr>
      <th>54</th>
      <td>NaN</td>
      <td>135</td>
      <td>PC3</td>
      <td>ATP-synt_ab_Xtn; ATPsynthase alpha/beta subuni...</td>
    </tr>
    <tr>
      <th>55</th>
      <td>NaN</td>
      <td>2113</td>
      <td>PC4</td>
      <td>Rav1p_C; RAVE complex protein Rav1 C-terminal</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>270</th>
      <td>NaN</td>
      <td>1362</td>
      <td>PC253</td>
      <td>MDM31_MDM32; Mitochondrial distribution and mo...</td>
    </tr>
    <tr>
      <th>271</th>
      <td>NaN</td>
      <td>1784</td>
      <td>PC254</td>
      <td>PMP1_2; Plasma membrane ATPase proteolipid</td>
    </tr>
    <tr>
      <th>272</th>
      <td>NaN</td>
      <td>861</td>
      <td>PC258</td>
      <td>FAD-oxidase_C; FAD-linked oxidase, C-terminal</td>
    </tr>
    <tr>
      <th>273</th>
      <td>NaN</td>
      <td>1002</td>
      <td>PC259</td>
      <td>GSHPx; Glutathione peroxidase</td>
    </tr>
    <tr>
      <th>274</th>
      <td>NaN</td>
      <td>625</td>
      <td>PC263</td>
      <td>DRE2_N; Fe-S cluster assembly protein Dre2, N-...</td>
    </tr>
  </tbody>
</table>
<p>224 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of exclusive domains from non SL pairs, after PCA, is = &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl_exclusive</span><span class="p">),</span> <span class="s1">&#39;out of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_sl</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl</span><span class="p">),</span> <span class="s1">&#39;so the&#39;</span><span class="p">,</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl_exclusive</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sl</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl</span><span class="p">)),</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>The number of exclusive domains from non SL pairs, after PCA, is =  275 out of 549 so the 50.09107468123862 %
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="let-see-to-the-domains-number-that-get-repeated-after-the-pca-analysis-and-selecting-the-most-explanatory-feature-by-its-explained-variance">
<h2>Let see to the domains-number that get repeated after the PCA analysis , and selecting the most explanatory feature by its explained variance.<a class="headerlink" href="#let-see-to-the-domains-number-that-get-repeated-after-the-pca-analysis-and-selecting-the-most-explanatory-feature-by-its-explained-variance" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">duplicated_features_sl</span><span class="o">=</span><span class="n">df_sl</span><span class="p">[</span><span class="n">df_sl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
<span class="n">repeated_features_sl</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">domains_name</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">domains_description</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-descrip&#39;</span><span class="p">])</span>

<span class="n">repeated_features_sl</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_name</span><span class="p">[</span><span class="n">duplicated_features_sl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span> 
<span class="n">repeated_features_sl</span><span class="p">[</span><span class="s1">&#39;domain-description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_description</span><span class="p">[</span><span class="n">duplicated_features_sl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">duplicated_features_nsl</span><span class="o">=</span><span class="n">df_nsl</span><span class="p">[</span><span class="n">df_nsl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
<span class="n">repeated_features_nsl</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">repeated_features_nsl</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_name</span><span class="p">[</span><span class="n">duplicated_features_nsl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span> 
<span class="n">repeated_features_nsl</span><span class="p">[</span><span class="s1">&#39;domain-description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_description</span><span class="p">[</span><span class="n">duplicated_features_nsl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">only_sl_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">repeated_features_sl</span><span class="p">,</span><span class="n">repeated_features_nsl</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">data_only_sl</span> <span class="o">=</span> <span class="n">only_sl_pd</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">only_sl_pd</span><span class="p">[</span><span class="s1">&#39;domain-description_y&#39;</span><span class="p">])]</span>
<span class="n">data_only_sl</span><span class="p">[</span><span class="s1">&#39;domain-description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data_only_sl</span><span class="p">[</span><span class="s1">&#39;domain-description_x&#39;</span><span class="p">]</span>
<span class="n">data_only_sl</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">df_sl_exclusive</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda3/envs/wintest/lib/python3.7/site-packages/ipykernel_launcher.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  This is separate from the ipykernel package so we can avoid doing imports until
</pre>
</div>
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>((49, 4), (291, 4))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">only_nsl_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">repeated_features_sl</span><span class="p">,</span><span class="n">repeated_features_nsl</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">data_only_nsl</span> <span class="o">=</span> <span class="n">only_nsl_pd</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">only_nsl_pd</span><span class="p">[</span><span class="s1">&#39;domain-description_x&#39;</span><span class="p">])]</span>
<span class="n">data_only_nsl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>domain-name</th>
      <th>domain-description_x</th>
      <th>domain-description_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>PF01483</td>
      <td>NaN</td>
      <td>DUF155; Domain of unknown function DUF155</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PF01388</td>
      <td>NaN</td>
      <td>DNA_pol3_delta2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PF08148</td>
      <td>NaN</td>
      <td>PRP21_like_P; Splicing factor 3A subunit 1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PF08662</td>
      <td>NaN</td>
      <td>RNA_pol_Rpb2_2; RNA polymerase Rpb2, domain 2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>PF11517</td>
      <td>NaN</td>
      <td>SQHop_cyclase_N; Squalene cyclase, N-terminal</td>
    </tr>
    <tr>
      <th>6</th>
      <td>PF00080</td>
      <td>NaN</td>
      <td>AATF-Che1; AATF leucine zipper-containing domain</td>
    </tr>
    <tr>
      <th>7</th>
      <td>PF01230</td>
      <td>NaN</td>
      <td>DASH_Dam1; DASH complex subunit Dam1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>PF00023</td>
      <td>NaN</td>
      <td>4HBT; Thioesterase domain</td>
    </tr>
    <tr>
      <th>9</th>
      <td>PF01363</td>
      <td>NaN</td>
      <td>DNA_RNApol_7kD; RNA polymerase archaeal subuni...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>PF02466</td>
      <td>NaN</td>
      <td>FTHFS; Formate-tetrahydrofolate ligase, FTHFS</td>
    </tr>
    <tr>
      <th>11</th>
      <td>PF03367</td>
      <td>NaN</td>
      <td>HAT_KAT11; Histone acetyltransferase Rtt109/CBP</td>
    </tr>
    <tr>
      <th>12</th>
      <td>PF03105</td>
      <td>NaN</td>
      <td>Glyco_hydro_16; Glycoside hydrolase family 16</td>
    </tr>
    <tr>
      <th>13</th>
      <td>PF02150</td>
      <td>NaN</td>
      <td>EXOSC1; Exosome complex component CSL4</td>
    </tr>
    <tr>
      <th>14</th>
      <td>PF00268</td>
      <td>NaN</td>
      <td>ATP-synt_ab; ATPase, F1/V1/A1 complex, alpha/b...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>PF06046</td>
      <td>NaN</td>
      <td>Nop16; Ribosome biogenesis protein Nop16</td>
    </tr>
    <tr>
      <th>16</th>
      <td>PF15469</td>
      <td>NaN</td>
      <td>Vps4_C; Vps4 oligomerisation, C-terminal</td>
    </tr>
    <tr>
      <th>17</th>
      <td>PF00735</td>
      <td>NaN</td>
      <td>CLP1_P; Polyribonucleotide 5&amp;apos;-hydroxyl-ki...</td>
    </tr>
    <tr>
      <th>18</th>
      <td>PF01423</td>
      <td>NaN</td>
      <td>DNA_topoisoIV; DNA topoisomerase, type IIA, su...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>PF04116</td>
      <td>NaN</td>
      <td>LCAT; Lecithin:cholesterol/phospholipid:diacyl...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>PF02996</td>
      <td>NaN</td>
      <td>Gal_mutarotas_2; Glycoside hydrolase family 31...</td>
    </tr>
    <tr>
      <th>21</th>
      <td>PF03256</td>
      <td>NaN</td>
      <td>Gsf2; Glucose signalling factor 2</td>
    </tr>
    <tr>
      <th>22</th>
      <td>PF05625</td>
      <td>NaN</td>
      <td>NMD3</td>
    </tr>
    <tr>
      <th>23</th>
      <td>PF11957</td>
      <td>NaN</td>
      <td>Sec16; Sec16, central conserved domain</td>
    </tr>
    <tr>
      <th>24</th>
      <td>PF07572</td>
      <td>NaN</td>
      <td>PGAP1; GPI inositol-deacylase PGAP1-like</td>
    </tr>
    <tr>
      <th>25</th>
      <td>PF01494</td>
      <td>NaN</td>
      <td>DUF1691; Domain of unknown function DUF1691</td>
    </tr>
    <tr>
      <th>26</th>
      <td>PF03637</td>
      <td>NaN</td>
      <td>HTH_44; Helix-turn-helix DNA-binding domain of...</td>
    </tr>
    <tr>
      <th>27</th>
      <td>PF03637</td>
      <td>NaN</td>
      <td>HTH_44; Helix-turn-helix DNA-binding domain of...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>PF14308</td>
      <td>NaN</td>
      <td>UBA_e1_thiolCys; Ubiquitin-activating enzyme, ...</td>
    </tr>
    <tr>
      <th>29</th>
      <td>PF03357</td>
      <td>NaN</td>
      <td>HAND; ISWI, HAND domain</td>
    </tr>
    <tr>
      <th>30</th>
      <td>PF04893</td>
      <td>NaN</td>
      <td>Med22; Mediator of RNA polymerase II transcrip...</td>
    </tr>
    <tr>
      <th>31</th>
      <td>PF04147</td>
      <td>NaN</td>
      <td>LSM; LSM domain, eukaryotic/archaea-type</td>
    </tr>
    <tr>
      <th>32</th>
      <td>PF12862</td>
      <td>NaN</td>
      <td>TCTP; Translationally controlled tumour protein</td>
    </tr>
    <tr>
      <th>33</th>
      <td>PF12862</td>
      <td>NaN</td>
      <td>TCTP; Translationally controlled tumour protein</td>
    </tr>
    <tr>
      <th>34</th>
      <td>PF12751</td>
      <td>NaN</td>
      <td>Striatin; Striatin, N-terminal</td>
    </tr>
    <tr>
      <th>35</th>
      <td>PF01255</td>
      <td>NaN</td>
      <td>DEAD_2; DEAD2</td>
    </tr>
    <tr>
      <th>36</th>
      <td>PF01255</td>
      <td>NaN</td>
      <td>DEAD_2; DEAD2</td>
    </tr>
    <tr>
      <th>37</th>
      <td>PF02752</td>
      <td>NaN</td>
      <td>Fumble; Type II pantothenate kinase</td>
    </tr>
    <tr>
      <th>38</th>
      <td>PF01283</td>
      <td>NaN</td>
      <td>DHO_dh; Dihydroorotate dehydrogenase domain</td>
    </tr>
    <tr>
      <th>39</th>
      <td>PF00909</td>
      <td>NaN</td>
      <td>CTD</td>
    </tr>
    <tr>
      <th>40</th>
      <td>PF00833</td>
      <td>NaN</td>
      <td>CPL; CPL domain</td>
    </tr>
    <tr>
      <th>41</th>
      <td>PF03452</td>
      <td>NaN</td>
      <td>HHH_5</td>
    </tr>
    <tr>
      <th>42</th>
      <td>PF00118</td>
      <td>NaN</td>
      <td>AD; Anticodon-binding domain</td>
    </tr>
    <tr>
      <th>43</th>
      <td>PF05238</td>
      <td>NaN</td>
      <td>Myb_Cef; Pre-mRNA splicing factor component Cd...</td>
    </tr>
    <tr>
      <th>44</th>
      <td>PF05032</td>
      <td>NaN</td>
      <td>MgsA_C; MgsA AAA+ ATPase C-terminal</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shared_domains_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">repeated_features_sl</span><span class="p">,</span><span class="n">repeated_features_nsl</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">shared_domains_pd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>domain-name</th>
      <th>domain-description_x</th>
      <th>domain-description_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PF04423</td>
      <td>MARVEL; Marvel domain</td>
      <td>MARVEL; Marvel domain</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a_sl</span><span class="o">=</span><span class="n">x_sl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">df_sl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">a_sl</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
<span class="n">a_sl</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(0.0, 0.2)
</pre></div>
</div>
<img alt="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_47_1.png" src="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_47_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a_nsl</span><span class="o">=</span><span class="n">x_nsl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">df_nsl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">a_nsl</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
<span class="n">a_nsl</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(0.0, 0.2)
</pre></div>
</div>
<img alt="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_48_1.png" src="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_48_1.png" />
</div>
</div>
<div class="section" id="proof-of-concept-with-bem1">
<h3>Proof of concept with <em>BEM1</em><a class="headerlink" href="#proof-of-concept-with-bem1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Gather the domains of SL and nSL pairs from BEM1</p></li>
<li><p>Check if the domains for the SL and nSL pairs are inside the most important domains after PCA.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">domains_bem1</span><span class="o">=</span><span class="n">data_domains</span><span class="p">[</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;BEM1&#39;</span><span class="p">][</span><span class="s1">&#39;domain-descrip&#39;</span><span class="p">]</span>
<span class="n">sl_bem1</span><span class="o">=</span><span class="n">data_sl</span><span class="p">[</span><span class="n">data_sl</span><span class="p">[</span><span class="s1">&#39;gene-query-name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;BEM1&#39;</span><span class="p">][</span><span class="s1">&#39;gene-target-name&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sl_bem1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>2846      BEM2
2847     CDC24
5004      MSB1
13777     SMI1
13778     BNI1
13779     BEM2
14385     SKN7
Name: gene-target-name, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_sl</span><span class="p">[</span><span class="n">data_sl</span><span class="p">[</span><span class="s1">&#39;gene-query-name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;BEM1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene-query</th>
      <th>gene-target</th>
      <th>gene-query-name</th>
      <th>gene-target-name</th>
      <th>gene-query-description</th>
      <th>gene-target-description</th>
      <th>interaction-type</th>
      <th>paper-source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2846</th>
      <td>YBR200W</td>
      <td>YER155C</td>
      <td>BEM1</td>
      <td>BEM2</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>IPL2|SUP9|TSL1|L000000168</td>
      <td>Synthetic Lethality</td>
      <td>Peterson J (1994)</td>
    </tr>
    <tr>
      <th>2847</th>
      <td>YBR200W</td>
      <td>YAL041W</td>
      <td>BEM1</td>
      <td>CDC24</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>CLS4|Rho family guanine nucleotide exchange fa...</td>
      <td>Synthetic Lethality</td>
      <td>Peterson J (1994)</td>
    </tr>
    <tr>
      <th>5004</th>
      <td>YBR200W</td>
      <td>YOR188W</td>
      <td>BEM1</td>
      <td>MSB1</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>L000001184</td>
      <td>Synthetic Lethality</td>
      <td>Bender A (1991)</td>
    </tr>
    <tr>
      <th>13777</th>
      <td>YBR200W</td>
      <td>YGR229C</td>
      <td>BEM1</td>
      <td>SMI1</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>KNR4|L000000909</td>
      <td>Synthetic Lethality</td>
      <td>Gorelik M (2011)</td>
    </tr>
    <tr>
      <th>13778</th>
      <td>YBR200W</td>
      <td>YNL271C</td>
      <td>BEM1</td>
      <td>BNI1</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>PPF3|SHE5|formin BNI1|L000000190</td>
      <td>Synthetic Lethality</td>
      <td>Gorelik M (2011)</td>
    </tr>
    <tr>
      <th>13779</th>
      <td>YBR200W</td>
      <td>YER155C</td>
      <td>BEM1</td>
      <td>BEM2</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>IPL2|SUP9|TSL1|L000000168</td>
      <td>Synthetic Lethality</td>
      <td>Gorelik M (2011)</td>
    </tr>
    <tr>
      <th>14385</th>
      <td>YBR200W</td>
      <td>YHR206W</td>
      <td>BEM1</td>
      <td>SKN7</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>BRY1|POS9|kinase-regulated stress-responsive t...</td>
      <td>Dosage Lethality</td>
      <td>Bouquin N (1999)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="prot_domains2lethality-PAPER-REPLICATION.html" title="previous page">Replication of results from paper: “Predicting yeast synthetic lethal genetic interactions using protein domains”</a>
    <a class='right-next' id="next-link" href="evaluating-protein-domains-per-module.html" title="next page">What is the protein domain profile of genes from the same module ?</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Leila Iñigo<br/>
        
            &copy; Copyright GPL License 3.0.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>