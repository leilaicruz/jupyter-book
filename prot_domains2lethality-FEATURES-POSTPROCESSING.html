

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>3. Feature postprocessing from paper. &#8212; Notebooks for data science</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="1. What are the most present protein domains per biological function?" href="evaluating-protein-domains-per-module.html" />
    <link rel="prev" title="2. Replication of results from paper: “Predicting yeast synthetic lethal genetic interactions using protein domains”" href="prot_domains2lethality-PAPER-REPLICATION.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/butterfly.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Notebooks for data science</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <p class="caption">
 <span class="caption-text">
  Get started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="test-folder/MysT_Notebooks.html">
   1. Notebooks written entirely in markdown
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="test-folder/python_by_example.html">
   2. An Introductory Example
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Machine learning related projects
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="tutorial-categorical-data-on-yeast-interactions.html">
   1. Tutorial on how to handle categorical data from here
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prot_domains2lethality-PAPER-REPLICATION.html">
   2. Replication of results from paper: “Predicting yeast synthetic lethal genetic interactions using protein domains”
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   3. Feature postprocessing from paper.
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Bioinformatics examples
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="evaluating-protein-domains-per-module.html">
   1. What are the most present protein domains per biological function?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="paralogs-and-SL-pairs.html">
   2. Paralogs and synthetic lethals
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/prot_domains2lethality-FEATURES-POSTPROCESSING.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/prot_domains2lethality-FEATURES-POSTPROCESSING.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/leilaicruz/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/leilaicruz/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fprot_domains2lethality-FEATURES-POSTPROCESSING.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/leilaicruz/jupyter-book/master?urlpath=tree/mini_book/docs/prot_domains2lethality-FEATURES-POSTPROCESSING.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#importing-datasets">
   3.1. Importing datasets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#link-to-the-github-repo-where-the-datasets-to-be-downloaded">
     3.1.1. Link to the github repo where the datasets to be downloaded:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#building-the-feature-matrix">
   3.2. Building the feature matrix
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building-the-list-of-proteins-domains-id-per-protein-pair-separately">
     3.2.1. Building the list of proteins domains id per protein pair separately :
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#postprocessing-1-remove-protein-pairs-from-study-if-either-protein-in-the-pair-does-not-contain-any-domain">
     3.2.2. Postprocessing #1:  Remove protein pairs from study if either protein in the pair does not contain any domain
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#feature-engineering-select-from-each-ordered-indexes-of-domain-id-list-which-of-them-appear-once-in-both-or-in-any-of-the-domains-of-each-protein-pair">
     3.2.3. Feature engineering: Select from each ordered indexes of domain id list which of them appear once, in both or in any of the domains of each protein pair
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#define-function-get-indexes">
       3.2.3.1. Define function
       <code class="docutils literal notranslate">
        <span class="pre">
         get_indexes
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-many-ones-and-twos-are-in-each-dataset">
     3.2.4. How many ones and twos are in each dataset
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bar-plot-to-visualize-these-numbers">
       3.2.4.1. Bar plot to visualize these numbers
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#adding-the-labels-response-variables-to-each-dataset">
       3.2.4.2. Adding the labels(response variables) to each dataset
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#joining-both-datasets">
       3.2.4.3. Joining both datasets
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#postprocessing-and-exploration-of-the-feature-matrix-of-both-datasets">
     3.2.5. Postprocessing and exploration of the feature matrix of both datasets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#viz-of-the-stats">
     3.2.6. Viz of the stats
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-redundant-are-each-of-the-protein-domains">
   3.3. How redundant are each of the protein domains?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#which-are-the-shared-domains-between-nsl-and-sl-pairs-in-the-pca-reduced-samples">
   3.4. which are the shared domains between nSL and SL pairs , in the PCA reduced samples
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#domains-exclusive-to-sl">
   3.5. Domains exclusive to SL
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#let-see-to-the-domains-number-that-get-repeated-after-the-pca-analysis-and-selecting-the-most-explanatory-feature-by-its-explained-variance">
   3.6. Let see to the domains-number that get repeated after the PCA analysis , and selecting the most explanatory feature by its explained variance.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#proof-of-concept-with-bem1">
     3.6.1. Proof of concept with
     <em>
      BEM1
     </em>
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="feature-postprocessing-from-paper">
<h1><span class="section-number">3. </span>Feature postprocessing from paper.<a class="headerlink" href="#feature-postprocessing-from-paper" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Title:  “Predicting yeast synthetic lethal genetic interactions using protein domains”</p></li>
<li><p>Authors: Bo Li, Feng Luo,School of Computing,Clemson University,Clemson, SC, USA</p></li>
<li><p>e-mail: bol, luofeng&#64;clemson.edu</p></li>
<li><p>year:2009</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span> 
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">random</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="importing-datasets">
<h2><span class="section-number">3.1. </span>Importing datasets<a class="headerlink" href="#importing-datasets" title="Permalink to this headline">¶</a></h2>
<div class="section" id="link-to-the-github-repo-where-the-datasets-to-be-downloaded">
<h3><span class="section-number">3.1.1. </span>Link to the github repo where the datasets to be downloaded:<a class="headerlink" href="#link-to-the-github-repo-where-the-datasets-to-be-downloaded" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/leilaicruz/machine-learning-for-yeast/tree/dev_Leila/datasets-for-learning">DOWNLOAD THE DATASETS HERE</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="s1">&#39;__file__&#39;</span><span class="p">)</span> <span class="c1">#&lt;-- absolute dir the script is in</span>
<span class="n">rel_path_SL</span> <span class="o">=</span> <span class="s2">&quot;datasets/data-synthetic-lethals.xlsx&quot;</span>
<span class="n">rel_path_nSL</span><span class="o">=</span><span class="s2">&quot;datasets/data-positive-genetic.xlsx&quot;</span>
<span class="n">rel_path_domains</span><span class="o">=</span><span class="s2">&quot;datasets/proteins-domains-from-Pfam.xlsx&quot;</span>

<span class="n">abs_file_path_SL</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="n">rel_path_SL</span><span class="p">)</span>
<span class="n">abs_file_path_nSL</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="n">rel_path_nSL</span><span class="p">)</span>
<span class="n">abs_file_path_domains</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="n">rel_path_domains</span><span class="p">)</span>

<span class="c1"># os.chdir(&#39;mini_book/docs/&#39;) #&lt;-- for binder os.chdir(&#39;../&#39;)</span>
<span class="c1"># os.chdir(&#39;../&#39;)</span>
<span class="n">my_path_sl</span><span class="o">=</span> <span class="n">abs_file_path_SL</span>
<span class="n">my_path_non_sl</span><span class="o">=</span><span class="n">abs_file_path_nSL</span>
<span class="n">my_path_domains</span><span class="o">=</span><span class="n">abs_file_path_domains</span>

<span class="n">data_sl</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">my_path_sl</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data_domains</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">my_path_domains</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">)</span>
<span class="n">data_domains</span><span class="o">=</span><span class="n">data_domains</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">data_nonsl</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">my_path_non_sl</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="building-the-feature-matrix">
<h2><span class="section-number">3.2. </span>Building the feature matrix<a class="headerlink" href="#building-the-feature-matrix" title="Permalink to this headline">¶</a></h2>
<p>One matrix for true SL where each row is one pair of SL. Every raw will be a vector of 0,1 or 2 depending on the comparison with the domain list. For row i the jth element = 0 if the jth element of the domain list is not in neither protein A and B, 1, if it is in one of them and 2 if it is in both of them .</p>
<div class="section" id="building-the-list-of-proteins-domains-id-per-protein-pair-separately">
<h3><span class="section-number">3.2.1. </span>Building the list of proteins domains id per protein pair separately :<a class="headerlink" href="#building-the-list-of-proteins-domains-id-per-protein-pair-separately" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>List of protein A: Search for the Sl/nSL database the query gene name and look in the protein domain database which protein domains id has each of those queries.</p></li>
<li><p>List of protein B: Search for the Sl/nSL database the target gene name of the previous query and look in the protein domain database which protein domains id has each of those target genes.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Selecting the meaningful columns in the respective dataset</span>
<span class="n">domain_id_list</span><span class="o">=</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span>
<span class="n">query_gene</span><span class="o">=</span><span class="n">data_sl</span><span class="p">[</span><span class="s1">&#39;gene-query-name&#39;</span><span class="p">]</span>
<span class="n">target_gene</span><span class="o">=</span><span class="n">data_sl</span><span class="p">[</span><span class="s1">&#39;gene-target-name&#39;</span><span class="p">]</span>
<span class="n">query_gene_nonlethal</span><span class="o">=</span><span class="n">data_nonsl</span><span class="p">[</span><span class="s1">&#39;gene-query-name&#39;</span><span class="p">]</span>
<span class="n">target_gene_nonlethal</span><span class="o">=</span><span class="n">data_nonsl</span><span class="p">[</span><span class="s1">&#39;gene-target-name&#39;</span><span class="p">]</span>



<span class="c1"># Initialising the arrays</span>
<span class="n">protein_a_list</span><span class="o">=</span><span class="p">[]</span>
<span class="n">protein_b_list</span><span class="o">=</span><span class="p">[]</span>
<span class="n">protein_a_list_non</span><span class="o">=</span><span class="p">[]</span>
<span class="n">protein_b_list_non</span><span class="o">=</span><span class="p">[]</span>

<span class="n">population</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data_sl</span><span class="p">))</span>

<span class="c1"># For loop for 10000 pairs sampled randomly from the SL/nSl pair list , and creating a big array of proteind domains id per protein pair</span>

<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">population</span><span class="p">),</span> <span class="mi">500</span><span class="p">):</span>
    <span class="n">protein_a</span><span class="o">=</span><span class="n">data_domains</span><span class="p">[</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">query_gene</span><span class="p">[</span><span class="n">m</span><span class="p">]]</span>
    <span class="n">protein_b</span><span class="o">=</span><span class="n">data_domains</span><span class="p">[</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">target_gene</span><span class="p">[</span><span class="n">m</span><span class="p">]]</span>
    <span class="n">protein_a_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protein_a</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="n">protein_b_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protein_b</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

    <span class="n">protein_a_non</span><span class="o">=</span><span class="n">data_domains</span><span class="p">[</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">query_gene_nonlethal</span><span class="p">[</span><span class="n">m</span><span class="p">]]</span>
    <span class="n">protein_b_non</span><span class="o">=</span><span class="n">data_domains</span><span class="p">[</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">target_gene_nonlethal</span><span class="p">[</span><span class="n">m</span><span class="p">]]</span>
    <span class="n">protein_a_list_non</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protein_a_non</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="n">protein_b_list_non</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protein_b_non</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;We are going to analyze&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">((</span><span class="n">protein_a_list</span><span class="p">))</span> <span class="p">,</span><span class="s1">&#39;protein pairs, out of&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data_sl</span><span class="p">),</span><span class="s1">&#39;SL protein pairs&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;We are going to analyze&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">((</span><span class="n">protein_a_list_non</span><span class="p">))</span> <span class="p">,</span><span class="s1">&#39;protein pairs, out of&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data_nonsl</span><span class="p">),</span><span class="s1">&#39;positive protein pairs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>We are going to analyze 500 protein pairs, out of 17871 SL protein pairs
We are going to analyze 500 protein pairs, out of 43340 positive protein pairs
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="postprocessing-1-remove-protein-pairs-from-study-if-either-protein-in-the-pair-does-not-contain-any-domain">
<h3><span class="section-number">3.2.2. </span>Postprocessing #1:  Remove protein pairs from study if either protein in the pair does not contain any domain<a class="headerlink" href="#postprocessing-1-remove-protein-pairs-from-study-if-either-protein-in-the-pair-does-not-contain-any-domain" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">remove_empty_domains</span><span class="p">(</span><span class="n">protein_list_search</span><span class="p">,</span><span class="n">protein_list_pair</span><span class="p">):</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_list_search</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">protein_list_search</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="p">[]</span> <span class="ow">or</span> <span class="n">protein_list_pair</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="p">[]:</span>
            <span class="n">index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="c1">## index of empty values for the protein_a_list meaning they dont have any annotated domain</span>

    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_list_search</span><span class="p">))</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index</span><span class="p">]</span> <span class="c1"># a list with non empty values from protein_a list</span>

    <span class="n">protein_list_search_new</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">protein_list_pair_new</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y</span><span class="p">:</span>
        <span class="n">protein_list_search_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protein_list_search</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">protein_list_pair_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protein_list_pair</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">protein_list_search_new</span><span class="p">,</span><span class="n">protein_list_pair_new</span>

<span class="c1">## evaluating the function</span>

<span class="n">protein_a_list_new</span><span class="p">,</span><span class="n">protein_b_list_new</span><span class="o">=</span><span class="n">remove_empty_domains</span><span class="p">(</span><span class="n">protein_a_list</span><span class="p">,</span><span class="n">protein_b_list</span><span class="p">)</span>

<span class="n">protein_a_list_non_new</span><span class="p">,</span><span class="n">protein_b_list_non_new</span><span class="o">=</span><span class="n">remove_empty_domains</span><span class="p">(</span><span class="n">protein_a_list_non</span><span class="p">,</span><span class="n">protein_b_list_non</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The empty domain in the SL were:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_new</span><span class="p">),</span> <span class="s1">&#39;out of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list</span><span class="p">),</span><span class="s1">&#39;domains&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The empty domain in the nSL were:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_non</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_non_new</span><span class="p">),</span> <span class="s1">&#39;out of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_non</span><span class="p">),</span><span class="s1">&#39;domains&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>The empty domain in the SL were: 70 out of 500 domains
The empty domain in the nSL were: 95 out of 500 domains
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="feature-engineering-select-from-each-ordered-indexes-of-domain-id-list-which-of-them-appear-once-in-both-or-in-any-of-the-domains-of-each-protein-pair">
<h3><span class="section-number">3.2.3. </span>Feature engineering: Select from each ordered indexes of domain id list which of them appear once, in both or in any of the domains of each protein pair<a class="headerlink" href="#feature-engineering-select-from-each-ordered-indexes-of-domain-id-list-which-of-them-appear-once-in-both-or-in-any-of-the-domains-of-each-protein-pair" title="Permalink to this headline">¶</a></h3>
<div class="section" id="define-function-get-indexes">
<h4><span class="section-number">3.2.3.1. </span>Define function <code class="docutils literal notranslate"><span class="pre">get_indexes</span></code><a class="headerlink" href="#define-function-get-indexes" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get_indexes</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">xs</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)))</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">]</span> <span class="c1"># a function that give the index of whether a value appear in array or not</span>
<span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="n">get_indexes</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[1, 2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">feature_building</span><span class="p">(</span><span class="n">protein_a_list_new</span><span class="p">,</span><span class="n">protein_b_list_new</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">domain_id_list</span><span class="p">)</span>
    <span class="c1">## To avoid taking repeated domains from one protein of the pairs , lets reduced the domains of each protein from the pairs to their unique members</span>
    <span class="n">protein_a_list_unique</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">protein_b_list_unique</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_new</span><span class="p">)):</span>
        <span class="n">protein_a_list_unique</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">protein_a_list_new</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">protein_b_list_unique</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">protein_b_list_new</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        
    <span class="n">protein_feat_true</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_unique</span><span class="p">)))</span>
    <span class="n">pair_a_b_array</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_unique</span><span class="p">)):</span>
        <span class="n">index_a</span><span class="o">=</span><span class="p">[]</span>
        
        <span class="n">pair</span><span class="o">=</span><span class="p">[</span><span class="n">protein_a_list_unique</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">protein_b_list_unique</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">pair_a_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">pair_a_b_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair_a_b</span><span class="p">)</span>

    <span class="n">j</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pair_a_b_array</span><span class="p">:</span>  
        <span class="n">array</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">counts</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">m</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span><span class="n">array</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">protein_feat_true</span><span class="p">[</span><span class="n">get_indexes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span>
                
            <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">protein_feat_true</span><span class="p">[</span><span class="n">get_indexes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
        <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">protein_feat_true</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">protein_feat_true</span><span class="o">=</span><span class="n">feature_building</span><span class="p">(</span><span class="n">protein_b_list_new</span><span class="o">=</span><span class="n">protein_b_list_new</span><span class="p">,</span><span class="n">protein_a_list_new</span><span class="o">=</span><span class="n">protein_a_list_new</span><span class="p">)</span>
<span class="n">protein_feat_true_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">protein_feat_true</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">protein_feat_non_true</span><span class="o">=</span><span class="n">feature_building</span><span class="p">(</span><span class="n">protein_b_list_new</span><span class="o">=</span><span class="n">protein_b_list_non_new</span><span class="p">,</span><span class="n">protein_a_list_new</span><span class="o">=</span><span class="n">protein_a_list_non_new</span><span class="p">)</span>
<span class="n">protein_feat_non_true_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">protein_feat_non_true</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="how-many-ones-and-twos-are-in-each-dataset">
<h3><span class="section-number">3.2.4. </span>How many ones and twos are in each dataset<a class="headerlink" href="#how-many-ones-and-twos-are-in-each-dataset" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">index_2_true</span><span class="o">=</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
<span class="n">index_2_true_count</span><span class="o">=</span><span class="n">index_2_true</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">index_1_true</span><span class="o">=</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
<span class="n">index_1_true_count</span><span class="o">=</span><span class="n">index_1_true</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">index_2_nontrue</span><span class="o">=</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
<span class="n">index_2_nontrue_count</span><span class="o">=</span><span class="n">index_2_nontrue</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">index_1_nontrue</span><span class="o">=</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
<span class="n">index_1_nontrue_count</span><span class="o">=</span><span class="n">index_1_nontrue</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fraction of twos in the SL array is&#39;</span><span class="p">,</span><span class="n">index_2_true_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fraction of ones in the SL array is&#39;</span><span class="p">,</span><span class="n">index_1_true_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fraction of twos in the PI array is&#39;</span><span class="p">,</span><span class="n">index_2_nontrue_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fraction of ones in the PI array is&#39;</span><span class="p">,</span><span class="n">index_1_nontrue_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>fraction of twos in the SL array is 2.9982702287142033e-05
fraction of ones in the SL array is 0.0010032673457620604
fraction of twos in the PI array is 8.978675645342311e-06
fraction of ones in the PI array is 0.0009150086725844301
</pre></div>
</div>
</div>
</div>
<div class="section" id="bar-plot-to-visualize-these-numbers">
<h4><span class="section-number">3.2.4.1. </span>Bar plot to visualize these numbers<a class="headerlink" href="#bar-plot-to-visualize-these-numbers" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;fraction of 2 in the nSL&#39;</span><span class="p">,</span><span class="s1">&#39;fraction of 1 in the nSL&#39;</span><span class="p">],[</span><span class="n">index_2_nontrue_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span><span class="n">index_1_nontrue_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">))],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;lightblue&#39;</span><span class="p">]),</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;fraction of 2 in SL &#39;</span><span class="p">,</span><span class="s1">&#39;fraction of 1 in SL&#39;</span><span class="p">],[</span><span class="n">index_2_true_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span><span class="n">index_1_true_count</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">columns</span><span class="p">))],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;coral&#39;</span><span class="p">,</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fraction from the population&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>([0, 1, 2, 3],
 [Text(0, 0, &#39;&#39;), Text(0, 0, &#39;&#39;), Text(0, 0, &#39;&#39;), Text(0, 0, &#39;&#39;)])
</pre></div>
</div>
<img alt="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_18_1.png" src="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_18_1.png" />
</div>
</div>
</div>
<div class="section" id="adding-the-labels-response-variables-to-each-dataset">
<h4><span class="section-number">3.2.4.2. </span>Adding the labels(response variables) to each dataset<a class="headerlink" href="#adding-the-labels-response-variables-to-each-dataset" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">protein_feat_true_pd</span><span class="p">[</span><span class="s1">&#39;lethality&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_new</span><span class="p">)))</span>
<span class="n">protein_feat_non_true_pd</span><span class="p">[</span><span class="s1">&#39;lethality&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_non_new</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="joining-both-datasets">
<h4><span class="section-number">3.2.4.3. </span>Joining both datasets<a class="headerlink" href="#joining-both-datasets" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">feature_post</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">protein_feat_true_pd</span><span class="p">,</span><span class="n">protein_feat_non_true_pd</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">feature_post</span><span class="o">=</span><span class="n">feature_post</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_new</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_a_list_non_new</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of features are:&#39;</span><span class="p">,</span><span class="n">feature_post</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of samples are:&#39;</span><span class="p">,</span><span class="n">feature_post</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>The number of features are: 3026
The number of samples are: 835
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="postprocessing-and-exploration-of-the-feature-matrix-of-both-datasets">
<h3><span class="section-number">3.2.5. </span>Postprocessing and exploration of the feature matrix of both datasets<a class="headerlink" href="#postprocessing-and-exploration-of-the-feature-matrix-of-both-datasets" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="o">=</span><span class="n">feature_post</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
<span class="n">std</span><span class="o">=</span><span class="n">feature_post</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span>
<span class="n">lethality</span><span class="o">=</span><span class="n">feature_post</span><span class="p">[</span><span class="s1">&#39;lethality&#39;</span><span class="p">]</span>

<span class="n">corr_keys</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mean</span><span class="p">,</span><span class="n">std</span><span class="p">,</span><span class="n">lethality</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="viz-of-the-stats">
<h3><span class="section-number">3.2.6. </span>Viz of the stats<a class="headerlink" href="#viz-of-the-stats" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pair</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">corr_keys</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;lethality&#39;</span><span class="p">,</span><span class="n">diag_kind</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;reg&#39;</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)</span>
<span class="n">pair</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Pairplot to see data dependencies with Lethality&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">1.08</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.08, &#39;Pairplot to see data dependencies with Lethality&#39;)
</pre></div>
</div>
<img alt="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_26_1.png" src="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">feature_post</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lethality&quot;</span><span class="p">]),</span> <span class="n">feature_post</span><span class="p">[</span><span class="s2">&quot;lethality&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">x_sl</span><span class="o">=</span><span class="n">protein_feat_true_pd</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lethality&#39;</span><span class="p">])</span>
<span class="n">x_nsl</span><span class="o">=</span><span class="n">protein_feat_non_true_pd</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lethality&#39;</span><span class="p">])</span>

<span class="n">X_sl_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_sl</span><span class="p">)</span>
<span class="n">X_nsl_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_nsl</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_sl_scaled</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(430, 3025)
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="how-redundant-are-each-of-the-protein-domains">
<h2><span class="section-number">3.3. </span>How redundant are each of the protein domains?<a class="headerlink" href="#how-redundant-are-each-of-the-protein-domains" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">PCA_component_contribution</span><span class="p">(</span><span class="n">scaled_matrix</span><span class="p">,</span><span class="n">original_data</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_matrix</span><span class="p">)</span>
    <span class="c1">## apply dimensionality reduction to X_train</span>
    <span class="n">output_pca</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">scaled_matrix</span><span class="p">)</span>
    
    <span class="n">total</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">explained_variance_</span><span class="p">)</span>


   
    <span class="c1"># number of components , that it will be the number of main axes times the number of original components </span>
    <span class="n">n_pcs</span><span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">components_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># the amount of non redundant protein domains </span>

    <span class="c1"># get the index of the most important feature on EACH component</span>
    <span class="c1"># LIST COMPREHENSION HERE</span>
    <span class="n">most_important</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_pcs</span><span class="p">)]</span>

    <span class="n">initial_feature_names</span> <span class="o">=</span> <span class="n">original_data</span><span class="o">.</span><span class="n">columns</span>
    <span class="c1"># get the names</span>
    <span class="n">most_important_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_feature_names</span><span class="p">[</span><span class="n">most_important</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_pcs</span><span class="p">)]</span>
    

    <span class="c1"># LIST COMPREHENSION HERE AGAIN</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PC</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="n">most_important_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_pcs</span><span class="p">)}</span>

    <span class="c1"># build the dataframe</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pca-component&#39;</span><span class="p">,</span><span class="s1">&#39;domain-number&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">df</span><span class="p">,</span><span class="n">model</span><span class="o">.</span><span class="n">components_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_sl</span><span class="p">,</span><span class="n">components_pca_nsl</span><span class="o">=</span><span class="n">PCA_component_contribution</span><span class="p">(</span><span class="n">X_nsl_scaled</span><span class="p">,</span><span class="n">x_nsl</span><span class="p">)</span>
<span class="n">df_nsl</span><span class="p">,</span><span class="n">components_pca_sl</span><span class="o">=</span><span class="n">PCA_component_contribution</span><span class="p">(</span><span class="n">X_sl_scaled</span><span class="p">,</span><span class="n">x_sl</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_sl</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pca-component</th>
      <th>domain-number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PC0</td>
      <td>89</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PC1</td>
      <td>221</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PC2</td>
      <td>689</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PC3</td>
      <td>142</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PC4</td>
      <td>1260</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="which-are-the-shared-domains-between-nsl-and-sl-pairs-in-the-pca-reduced-samples">
<h2><span class="section-number">3.4. </span>which are the shared domains between nSL and SL pairs , in the PCA reduced samples<a class="headerlink" href="#which-are-the-shared-domains-between-nsl-and-sl-pairs-in-the-pca-reduced-samples" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_shared_domains</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_sl</span><span class="p">,</span><span class="n">df_nsl</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;domain-number&#39;</span><span class="p">)</span>
<span class="n">domains_name</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">domains_description</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-descrip&#39;</span><span class="p">])</span>

<span class="n">df_shared_domains</span><span class="p">[</span><span class="s1">&#39;domain-description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_description</span><span class="p">[</span><span class="n">df_shared_domains</span><span class="p">[</span><span class="s1">&#39;domain-number&#39;</span><span class="p">]]</span>


<span class="n">df_shared_domains</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pca-component_x</th>
      <th>domain-number</th>
      <th>pca-component_y</th>
      <th>domain-description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PC1</td>
      <td>221</td>
      <td>PC64</td>
      <td>Apq12; Nuclear pore assembly and biogenesis pr...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PC1</td>
      <td>221</td>
      <td>PC65</td>
      <td>Apq12; Nuclear pore assembly and biogenesis pr...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PC16</td>
      <td>350</td>
      <td>PC21</td>
      <td>CFIA_Pcf11; Subunit of cleavage factor IA Pcf11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PC17</td>
      <td>214</td>
      <td>PC67</td>
      <td>Anth_synt_I_N; Anthranilate synthase component...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PC20</td>
      <td>877</td>
      <td>PC48</td>
      <td>FF; FF domain</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>57</th>
      <td>PC223</td>
      <td>760</td>
      <td>PC37</td>
      <td>Dopey_N; Dopey, N-terminal</td>
    </tr>
    <tr>
      <th>58</th>
      <td>PC228</td>
      <td>1550</td>
      <td>PC105</td>
      <td>NAD_binding_7; Sirohaem synthase, N-terminal</td>
    </tr>
    <tr>
      <th>59</th>
      <td>PC254</td>
      <td>310</td>
      <td>PC148</td>
      <td>C1_1; Protein kinase C-like, phorbol ester/dia...</td>
    </tr>
    <tr>
      <th>60</th>
      <td>PC265</td>
      <td>778</td>
      <td>PC181</td>
      <td>E1_UFD; Ubiquitin-activating enzyme E1, C-term...</td>
    </tr>
    <tr>
      <th>61</th>
      <td>PC271</td>
      <td>510</td>
      <td>PC155</td>
      <td>Cpn10; GroES chaperonin family</td>
    </tr>
  </tbody>
</table>
<p>62 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of shared domains between SL and nSL pairs,after PCA, is = &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df_shared_domains</span><span class="p">),</span> <span class="s1">&#39;out of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_sl</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl</span><span class="p">),</span> <span class="s1">&#39;so the&#39;</span><span class="p">,</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df_shared_domains</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sl</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl</span><span class="p">)),</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>The number of shared domains between SL and nSL pairs,after PCA, is =  62 out of 552 so the 11.231884057971014 %
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="domains-exclusive-to-sl">
<h2><span class="section-number">3.5. </span>Domains exclusive to SL<a class="headerlink" href="#domains-exclusive-to-sl" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_sl_exclusive</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_sl</span><span class="p">,</span><span class="n">df_nsl</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;domain-number&#39;</span><span class="p">)</span>

<span class="n">domains_name</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">domains_description</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-descrip&#39;</span><span class="p">])</span>

<span class="n">df_sl_exclusive</span><span class="p">[</span><span class="s1">&#39;domain-description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_description</span><span class="p">[</span><span class="n">df_sl_exclusive</span><span class="p">[</span><span class="s1">&#39;domain-number&#39;</span><span class="p">]]</span>
<span class="n">df_sl_exclusive</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">df_sl_exclusive</span><span class="p">[</span><span class="s1">&#39;pca-component_y&#39;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pca-component_x</th>
      <th>domain-number</th>
      <th>pca-component_y</th>
      <th>domain-description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PC0</td>
      <td>89</td>
      <td>NaN</td>
      <td>ANAPC8; Cdc23</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PC2</td>
      <td>689</td>
      <td>NaN</td>
      <td>DUF3128; Protein of unknown function DUF3128</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PC3</td>
      <td>142</td>
      <td>NaN</td>
      <td>ATP_synt_H; ATPase, V0 complex, subunit e1/e2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>PC4</td>
      <td>1260</td>
      <td>NaN</td>
      <td>KOW</td>
    </tr>
    <tr>
      <th>6</th>
      <td>PC5</td>
      <td>58</td>
      <td>NaN</td>
      <td>AEP1; ATPase expression protein 1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>281</th>
      <td>PC268</td>
      <td>921</td>
      <td>NaN</td>
      <td>Flavokinase; Riboflavin kinase domain, bacteri...</td>
    </tr>
    <tr>
      <th>282</th>
      <td>PC269</td>
      <td>1728</td>
      <td>NaN</td>
      <td>PEX-1N; Peroxisome biogenesis factor 1, N-term...</td>
    </tr>
    <tr>
      <th>283</th>
      <td>PC270</td>
      <td>1295</td>
      <td>NaN</td>
      <td>LIM; Zinc finger, LIM-type</td>
    </tr>
    <tr>
      <th>285</th>
      <td>PC272</td>
      <td>684</td>
      <td>NaN</td>
      <td>DUF2611; Protein of unknown function DUF2611</td>
    </tr>
    <tr>
      <th>286</th>
      <td>PC273</td>
      <td>1040</td>
      <td>NaN</td>
      <td>Glucosamine_iso; Glucosamine/galactosamine-6-p...</td>
    </tr>
  </tbody>
</table>
<p>225 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of exclusive domains from SL pairs, after PCA, is = &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sl_exclusive</span><span class="p">),</span> <span class="s1">&#39;out of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_sl</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl</span><span class="p">),</span> <span class="s1">&#39;so the&#39;</span><span class="p">,</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sl_exclusive</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sl</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl</span><span class="p">)),</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>The number of exclusive domains from SL pairs, after PCA, is =  287 out of 552 so the 51.992753623188406 %
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_nsl_exclusive</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_sl</span><span class="p">,</span><span class="n">df_nsl</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;domain-number&#39;</span><span class="p">)</span>

<span class="n">domains_name</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">domains_description</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-descrip&#39;</span><span class="p">])</span>

<span class="n">df_nsl_exclusive</span><span class="p">[</span><span class="s1">&#39;domain-description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_description</span><span class="p">[</span><span class="n">df_nsl_exclusive</span><span class="p">[</span><span class="s1">&#39;domain-number&#39;</span><span class="p">]]</span>
<span class="n">df_nsl_exclusive</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">df_nsl_exclusive</span><span class="p">[</span><span class="s1">&#39;pca-component_x&#39;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pca-component_x</th>
      <th>domain-number</th>
      <th>pca-component_y</th>
      <th>domain-description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>1028</td>
      <td>PC0</td>
      <td>GatB_Yqey; Asn/Gln amidotransferase</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>305</td>
      <td>PC1</td>
      <td>Brr6_like_C_C; Brl1/Brr6 domain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>154</td>
      <td>PC2</td>
      <td>AcetylCoA_hydro; Acetyl-CoA hydrolase/transferase</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>611</td>
      <td>PC3</td>
      <td>DNA_pol_A; DNA-directed DNA polymerase, family...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>1252</td>
      <td>PC4</td>
      <td>JmjN; JmjN domain</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>277</th>
      <td>NaN</td>
      <td>1349</td>
      <td>PC270</td>
      <td>MARVEL; Marvel domain</td>
    </tr>
    <tr>
      <th>280</th>
      <td>NaN</td>
      <td>1650</td>
      <td>PC272</td>
      <td>Nup188; Nucleoporin Nup188</td>
    </tr>
    <tr>
      <th>281</th>
      <td>NaN</td>
      <td>363</td>
      <td>PC273</td>
      <td>CLP1_P; Polyribonucleotide 5&amp;apos;-hydroxyl-ki...</td>
    </tr>
    <tr>
      <th>282</th>
      <td>NaN</td>
      <td>107</td>
      <td>PC274</td>
      <td>ATE_N; Arginine-tRNA-protein transferase, N-te...</td>
    </tr>
    <tr>
      <th>285</th>
      <td>NaN</td>
      <td>2446</td>
      <td>PC277</td>
      <td>Sec39; Sec39 domain</td>
    </tr>
  </tbody>
</table>
<p>224 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of exclusive domains from non SL pairs, after PCA, is = &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl_exclusive</span><span class="p">),</span> <span class="s1">&#39;out of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_sl</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl</span><span class="p">),</span> <span class="s1">&#39;so the&#39;</span><span class="p">,</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl_exclusive</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sl</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">df_nsl</span><span class="p">)),</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>The number of exclusive domains from non SL pairs, after PCA, is =  286 out of 552 so the 51.81159420289855 %
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="let-see-to-the-domains-number-that-get-repeated-after-the-pca-analysis-and-selecting-the-most-explanatory-feature-by-its-explained-variance">
<h2><span class="section-number">3.6. </span>Let see to the domains-number that get repeated after the PCA analysis , and selecting the most explanatory feature by its explained variance.<a class="headerlink" href="#let-see-to-the-domains-number-that-get-repeated-after-the-pca-analysis-and-selecting-the-most-explanatory-feature-by-its-explained-variance" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">duplicated_features_sl</span><span class="o">=</span><span class="n">df_sl</span><span class="p">[</span><span class="n">df_sl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
<span class="n">repeated_features_sl</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">domains_name</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">domains_description</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;domain-descrip&#39;</span><span class="p">])</span>

<span class="n">repeated_features_sl</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_name</span><span class="p">[</span><span class="n">duplicated_features_sl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span> 
<span class="n">repeated_features_sl</span><span class="p">[</span><span class="s1">&#39;domain-description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_description</span><span class="p">[</span><span class="n">duplicated_features_sl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">duplicated_features_nsl</span><span class="o">=</span><span class="n">df_nsl</span><span class="p">[</span><span class="n">df_nsl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
<span class="n">repeated_features_nsl</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">repeated_features_nsl</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_name</span><span class="p">[</span><span class="n">duplicated_features_nsl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span> 
<span class="n">repeated_features_nsl</span><span class="p">[</span><span class="s1">&#39;domain-description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">domains_description</span><span class="p">[</span><span class="n">duplicated_features_nsl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">only_sl_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">repeated_features_sl</span><span class="p">,</span><span class="n">repeated_features_nsl</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">data_only_sl</span> <span class="o">=</span> <span class="n">only_sl_pd</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">only_sl_pd</span><span class="p">[</span><span class="s1">&#39;domain-description_y&#39;</span><span class="p">])]</span>
<span class="n">data_only_sl</span><span class="p">[</span><span class="s1">&#39;domain-description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data_only_sl</span><span class="p">[</span><span class="s1">&#39;domain-description_x&#39;</span><span class="p">]</span>
<span class="n">data_only_sl</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">df_sl_exclusive</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda3/envs/wintest/lib/python3.7/site-packages/ipykernel_launcher.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  This is separate from the ipykernel package so we can avoid doing imports until
</pre>
</div>
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>((39, 4), (287, 4))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">only_nsl_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">repeated_features_sl</span><span class="p">,</span><span class="n">repeated_features_nsl</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">data_only_nsl</span> <span class="o">=</span> <span class="n">only_nsl_pd</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">only_nsl_pd</span><span class="p">[</span><span class="s1">&#39;domain-description_x&#39;</span><span class="p">])]</span>
<span class="n">data_only_nsl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>domain-name</th>
      <th>domain-description_x</th>
      <th>domain-description_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PF00580</td>
      <td>NaN</td>
      <td>BRCT_2; BRCT domain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PF00183</td>
      <td>NaN</td>
      <td>ANAPC5; Anaphase-promoting complex subunit 5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PF01853</td>
      <td>NaN</td>
      <td>Dopey_N; Dopey, N-terminal</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PF02735</td>
      <td>NaN</td>
      <td>Frag1; Frag1/DRAM/Sfk1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>PF16892</td>
      <td>NaN</td>
      <td>tRNA-synt_1c_C; Glutamyl/glutaminyl-tRNA synth...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>PF05764</td>
      <td>NaN</td>
      <td>NPR3; Nitrogen permease regulator 3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>PF03177</td>
      <td>NaN</td>
      <td>Glyco_transf_4; Glycosyltransferase subfamily ...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>PF00454</td>
      <td>NaN</td>
      <td>Apq12; Nuclear pore assembly and biogenesis pr...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>PF04824</td>
      <td>NaN</td>
      <td>Mcp5_PH; Pleckstrin homology domain, Mcp5-type</td>
    </tr>
    <tr>
      <th>11</th>
      <td>PF00082</td>
      <td>NaN</td>
      <td>AA_kinase; Aspartate/glutamate/uridylate kinase</td>
    </tr>
    <tr>
      <th>12</th>
      <td>PF02765</td>
      <td>NaN</td>
      <td>Fun_ATP-synt_8; ATP synthase protein 8, fungi</td>
    </tr>
    <tr>
      <th>13</th>
      <td>PF04488</td>
      <td>NaN</td>
      <td>MDM31_MDM32; Mitochondrial distribution and mo...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>PF00083</td>
      <td>NaN</td>
      <td>AA_permease; Amino acid permease/ SLC12A domain</td>
    </tr>
    <tr>
      <th>15</th>
      <td>PF03908</td>
      <td>NaN</td>
      <td>IBB; Importin-alpha, importin-beta-binding domain</td>
    </tr>
    <tr>
      <th>16</th>
      <td>PF01896</td>
      <td>NaN</td>
      <td>Dynamin_M; Dynamin central domain</td>
    </tr>
    <tr>
      <th>17</th>
      <td>PF08312</td>
      <td>NaN</td>
      <td>Peptidase_M24_C; Peptidase M24, C-terminal domain</td>
    </tr>
    <tr>
      <th>18</th>
      <td>PF01127</td>
      <td>NaN</td>
      <td>Cohesin_HEAT; HEAT repeat associated with sist...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>PF05843</td>
      <td>NaN</td>
      <td>Na_Ca_ex; Sodium/calcium exchanger membrane re...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>PF00638</td>
      <td>NaN</td>
      <td>CAP; CAP domain</td>
    </tr>
    <tr>
      <th>21</th>
      <td>PF10568</td>
      <td>NaN</td>
      <td>SHQ1; SHQ1 protein</td>
    </tr>
    <tr>
      <th>22</th>
      <td>PF08653</td>
      <td>NaN</td>
      <td>RNA_pol_Rpb1_2; RNA polymerase, alpha subunit</td>
    </tr>
    <tr>
      <th>23</th>
      <td>PF01115</td>
      <td>NaN</td>
      <td>CoaE; Dephospho-CoA kinase</td>
    </tr>
    <tr>
      <th>24</th>
      <td>PF07572</td>
      <td>NaN</td>
      <td>PGAP1; GPI inositol-deacylase PGAP1-like</td>
    </tr>
    <tr>
      <th>25</th>
      <td>PF12220</td>
      <td>NaN</td>
      <td>Securin; Securin sister-chromatid separation i...</td>
    </tr>
    <tr>
      <th>26</th>
      <td>PF04762</td>
      <td>NaN</td>
      <td>Mak16; Mak16 protein</td>
    </tr>
    <tr>
      <th>27</th>
      <td>PF04658</td>
      <td>NaN</td>
      <td>MPS2; Monopolar spindle protein 2</td>
    </tr>
    <tr>
      <th>28</th>
      <td>PF06687</td>
      <td>NaN</td>
      <td>Opi1; Transcription factor Opi1</td>
    </tr>
    <tr>
      <th>29</th>
      <td>PF08690</td>
      <td>NaN</td>
      <td>RNA_pol_Rpb2_7; RNA polymerase Rpb2, domain 7</td>
    </tr>
    <tr>
      <th>30</th>
      <td>PF09794</td>
      <td>NaN</td>
      <td>Ribosomal_L22; Ribosomal protein L22/L17</td>
    </tr>
    <tr>
      <th>31</th>
      <td>PF13928</td>
      <td>NaN</td>
      <td>Tubulin; Tubulin/FtsZ, GTPase domain</td>
    </tr>
    <tr>
      <th>32</th>
      <td>PF12539</td>
      <td>NaN</td>
      <td>Sof1; Sof1-like protein</td>
    </tr>
    <tr>
      <th>33</th>
      <td>PF10471</td>
      <td>NaN</td>
      <td>SET; SET domain</td>
    </tr>
    <tr>
      <th>34</th>
      <td>PF00096</td>
      <td>NaN</td>
      <td>ABC2_membrane; ABC-2 type transporter</td>
    </tr>
    <tr>
      <th>35</th>
      <td>PF00352</td>
      <td>NaN</td>
      <td>AhpC-TSA; Alkyl hydroperoxide reductase subuni...</td>
    </tr>
    <tr>
      <th>36</th>
      <td>PF06747</td>
      <td>NaN</td>
      <td>Oxidored_FMN; NADH:flavin oxidoreductase/NADH ...</td>
    </tr>
    <tr>
      <th>37</th>
      <td>PF06747</td>
      <td>NaN</td>
      <td>Oxidored_FMN; NADH:flavin oxidoreductase/NADH ...</td>
    </tr>
    <tr>
      <th>38</th>
      <td>PF13824</td>
      <td>NaN</td>
      <td>Topo_C_assoc; Topoisomerase I C-terminal domain</td>
    </tr>
    <tr>
      <th>39</th>
      <td>PF03029</td>
      <td>NaN</td>
      <td>Gcd10p; tRNA (adenine(58)-N(1))-methyltransfer...</td>
    </tr>
    <tr>
      <th>40</th>
      <td>PF00909</td>
      <td>NaN</td>
      <td>CTD</td>
    </tr>
    <tr>
      <th>41</th>
      <td>PF03164</td>
      <td>NaN</td>
      <td>Glyco_transf_22; GPI mannosyltransferase</td>
    </tr>
    <tr>
      <th>42</th>
      <td>PF17060</td>
      <td>NaN</td>
      <td>zf-C2H2_jaz; Zinc finger, double-stranded RNA ...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>PF03371</td>
      <td>NaN</td>
      <td>HBS1_N; HBS1-like protein, N-terminal</td>
    </tr>
    <tr>
      <th>44</th>
      <td>PF00238</td>
      <td>NaN</td>
      <td>ATG7_N; Ubiquitin-like modifier-activating enz...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>PF11789</td>
      <td>NaN</td>
      <td>SWIRM; SWIRM domain</td>
    </tr>
    <tr>
      <th>46</th>
      <td>PF04190</td>
      <td>NaN</td>
      <td>Lge1</td>
    </tr>
    <tr>
      <th>47</th>
      <td>PF00561</td>
      <td>NaN</td>
      <td>BHD_1; Rad4 beta-hairpin domain 1</td>
    </tr>
    <tr>
      <th>48</th>
      <td>PF00503</td>
      <td>NaN</td>
      <td>B-block_TFIIIC; B-block binding subunit of TFIIIC</td>
    </tr>
    <tr>
      <th>49</th>
      <td>PF05625</td>
      <td>NaN</td>
      <td>NMD3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shared_domains_pd</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">repeated_features_sl</span><span class="p">,</span><span class="n">repeated_features_nsl</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;domain-name&#39;</span><span class="p">])</span>
<span class="n">shared_domains_pd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>domain-name</th>
      <th>domain-description_x</th>
      <th>domain-description_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PF12783</td>
      <td>Sybindin; Trafficking protein particle complex...</td>
      <td>Sybindin; Trafficking protein particle complex...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PF00160</td>
      <td>ALAD; Delta-aminolevulinic acid dehydratase</td>
      <td>ALAD; Delta-aminolevulinic acid dehydratase</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a_sl</span><span class="o">=</span><span class="n">x_sl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">df_sl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">a_sl</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
<span class="n">a_sl</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(0.0, 0.2)
</pre></div>
</div>
<img alt="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_47_1.png" src="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_47_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a_nsl</span><span class="o">=</span><span class="n">x_nsl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">df_nsl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">a_nsl</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
<span class="n">a_nsl</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(0.0, 0.2)
</pre></div>
</div>
<img alt="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_48_1.png" src="_images/prot_domains2lethality-FEATURES-POSTPROCESSING_48_1.png" />
</div>
</div>
<div class="section" id="proof-of-concept-with-bem1">
<h3><span class="section-number">3.6.1. </span>Proof of concept with <em>BEM1</em><a class="headerlink" href="#proof-of-concept-with-bem1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Gather the domains of SL and nSL pairs from BEM1</p></li>
<li><p>Check if the domains for the SL and nSL pairs are inside the most important domains after PCA.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">domains_bem1</span><span class="o">=</span><span class="n">data_domains</span><span class="p">[</span><span class="n">data_domains</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;BEM1&#39;</span><span class="p">][</span><span class="s1">&#39;domain-descrip&#39;</span><span class="p">]</span>
<span class="n">sl_bem1</span><span class="o">=</span><span class="n">data_sl</span><span class="p">[</span><span class="n">data_sl</span><span class="p">[</span><span class="s1">&#39;gene-query-name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;BEM1&#39;</span><span class="p">][</span><span class="s1">&#39;gene-target-name&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sl_bem1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>2846      BEM2
2847     CDC24
5004      MSB1
13777     SMI1
13778     BNI1
13779     BEM2
14385     SKN7
Name: gene-target-name, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_sl</span><span class="p">[</span><span class="n">data_sl</span><span class="p">[</span><span class="s1">&#39;gene-query-name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;BEM1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene-query</th>
      <th>gene-target</th>
      <th>gene-query-name</th>
      <th>gene-target-name</th>
      <th>gene-query-description</th>
      <th>gene-target-description</th>
      <th>interaction-type</th>
      <th>paper-source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2846</th>
      <td>YBR200W</td>
      <td>YER155C</td>
      <td>BEM1</td>
      <td>BEM2</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>IPL2|SUP9|TSL1|L000000168</td>
      <td>Synthetic Lethality</td>
      <td>Peterson J (1994)</td>
    </tr>
    <tr>
      <th>2847</th>
      <td>YBR200W</td>
      <td>YAL041W</td>
      <td>BEM1</td>
      <td>CDC24</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>CLS4|Rho family guanine nucleotide exchange fa...</td>
      <td>Synthetic Lethality</td>
      <td>Peterson J (1994)</td>
    </tr>
    <tr>
      <th>5004</th>
      <td>YBR200W</td>
      <td>YOR188W</td>
      <td>BEM1</td>
      <td>MSB1</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>L000001184</td>
      <td>Synthetic Lethality</td>
      <td>Bender A (1991)</td>
    </tr>
    <tr>
      <th>13777</th>
      <td>YBR200W</td>
      <td>YGR229C</td>
      <td>BEM1</td>
      <td>SMI1</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>KNR4|L000000909</td>
      <td>Synthetic Lethality</td>
      <td>Gorelik M (2011)</td>
    </tr>
    <tr>
      <th>13778</th>
      <td>YBR200W</td>
      <td>YNL271C</td>
      <td>BEM1</td>
      <td>BNI1</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>PPF3|SHE5|formin BNI1|L000000190</td>
      <td>Synthetic Lethality</td>
      <td>Gorelik M (2011)</td>
    </tr>
    <tr>
      <th>13779</th>
      <td>YBR200W</td>
      <td>YER155C</td>
      <td>BEM1</td>
      <td>BEM2</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>IPL2|SUP9|TSL1|L000000168</td>
      <td>Synthetic Lethality</td>
      <td>Gorelik M (2011)</td>
    </tr>
    <tr>
      <th>14385</th>
      <td>YBR200W</td>
      <td>YHR206W</td>
      <td>BEM1</td>
      <td>SKN7</td>
      <td>SRO1|phosphatidylinositol-3-phosphate-binding ...</td>
      <td>BRY1|POS9|kinase-regulated stress-responsive t...</td>
      <td>Dosage Lethality</td>
      <td>Bouquin N (1999)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="prot_domains2lethality-PAPER-REPLICATION.html" title="previous page"><span class="section-number">2. </span>Replication of results from paper: “Predicting yeast synthetic lethal genetic interactions using protein domains”</a>
    <a class='right-next' id="next-link" href="evaluating-protein-domains-per-module.html" title="next page"><span class="section-number">1. </span>What are the most present protein domains per biological function?</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Leila Iñigo<br/>
        
            &copy; Copyright GPL License 3.0.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>